<% SWITCH cmd %>
<% CASE 'USER_NOT_FOUND' %>
{
    "deleteMessage": { "message_id": "{{ message.message_id }}" }
},
{
    "sendMessage": {
        "text": "–ü—Ä–∏–≤–µ—Ç! –ú–µ–Ω—è –∑–æ–≤—É—Ç <b>{{ config.company.name }}</b>. –Ø —Å–¥–µ–ª–∞—é —Ç–≤–æ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –±–æ–ª–µ–µ –¥–æ—Å—Ç—É–ø–Ω—ã–º –∏ –æ—Ç–∫—Ä—ã—Ç—ã–º.\n\n- üîí –ê–±—Å–æ–ª—é—Ç–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –ª—é–±—ã–º —Å–æ—Ü–∏–∞–ª—å–Ω—ã–º —Å–µ—Ç—è–º\n- üåê –û–±—Ö–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π\n- üîì –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º\n- üîë –î–≤–æ–π–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö\n- üí≥ –û–ø–ª–∞—Ç–∞ —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ –∫–∞—Ä—Ç–∞–º–∏\n\n–ü—Ä–∏–Ω—è—Ç—å —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ:",
        "parse_mode": "HTML",
        "photo": "{{ config.logo.url }}",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "–°–æ–≥–ª–∞—à–µ–Ω–∏–µ",
                        "web_app": {
                            "url": "https://wwvpn.bine.life/privacy"
                        }
                    }
                ],
                [
                    {
                        "text": "‚úÖ –î–∞",
                        "callback_data": "/register {{ args.0 }}"
                    },
                    {
                        "text": "‚ùå –ù–µ—Ç",
                        "callback_data": "/disagree"
                    }
                ]
            ]
        }
    }
}

<% CASE '/disagree' %>
{
    "deleteMessage": { "message_id": "{{ message.message_id }}" }
},
{
    "sendMessage": {
        "text": "üö´ <b>–ë–µ–∑ –ø—Ä–∏–Ω—è—Ç–∏—è —É—Å–ª–æ–≤–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞ –º—ã –Ω–µ –º–æ–∂–µ–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É.</b>",
        "parse_mode": "HTML",
        "photo": "{{ config.logo.url }}",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üîô –ù–∞–∑–∞–¥",
                        "callback_data": "USER_NOT_FOUND"
                    }
                ]
            ]
        }
    }
}

<% CASE '/register' %>
{
    "deleteMessage": { "message_id": "{{ message.message_id }}" }
},
{
    "shmRegister": {
        "partner_id": "{{ args.0 }}",
        "callback_data": "/start",
        "error": "–û–®–ò–ë–ö–ê: –õ–æ–≥–∏–Ω {{ message.chat.username }} –∏–ª–∏ chat_id {{ message.chat.id }} —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
    }
}

<% CASE ['/start', '/menu', 'üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é', 'üîÑ –û–±–Ω–æ–≤–∏—Ç—å'] %>
{{ IF cmd != '/start' }}
{
    "deleteMessage": { 
        "message_id": {{ message.message_id }} 
    }
},
{{ END }}
{
    "sendPhoto": {
        "photo": "{{ config.logo.url }}",
        "caption": "üîê <b>–ù–∞—à–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:</b>\n\nüåç <b>{{ config.company.name }}:</b> –ë—ã—Å—Ç—Ä—ã–π, –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∏ –∞–Ω–æ–Ω–∏–º–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.\n\nüíº <b>–£–¥–æ–±—Å—Ç–≤–æ:</b> <a href=\"{{ config.apk.android }}\">üì≤ Android</a> | <a href=\"{{ config.apk.ios }}\">üì≤ iOS</a>\n\nüéØ <b>–ü–æ—á–µ–º—É –≤—ã–±–∏—Ä–∞—é—Ç –Ω–∞—Å?</b>\n‚úîÔ∏è –ü—Ä–æ—Å—Ç–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ\n‚úîÔ∏è –ù–∞–¥–µ–∂–Ω–∞—è –∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö\n‚úîÔ∏è –ö—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üí∞ –ë–∞–ª–∞–Ω—Å: {{ user.balance }} ‚ÇΩ",
                        "callback_data": "/balance"
                    },
                    {
                        "text": "‚ûï –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å",
                        "web_app": {
                            "url": "{{ config.api.url }}/shm/v1/public/tg_payments_webapp?format=html&user_id={{ user.id }}"
                        }
                    }
                ],
                [
                    {
                        "text": "üéÅ –í–≤–µ—Å—Ç–∏ –ø—Ä–æ–º–æ–∫–æ–¥",
                        "web_app": {
                            "url": "{{ config.api.url }}/shm/v1/public/promo?format=html&user_id={{ user.id }}"
                        }
                    }
                ],
                [
                    {
                        "text": "üõí –ö—É–ø–∏—Ç—å VPN",
                        "callback_data": "/pricelist"
                    },
                    {
                        "text": "üîë –ú–æ–∏ VPN –∫–ª—é—á–∏",
                        "callback_data": "/list"
                    }
                ],
                [
                    {
                        "text": "ü§ù –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞",
                        "callback_data": "/referrals"
                    },
                    {
                        "text": "üìñ –ü–æ–º–æ—â—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞",
                        "callback_data": "/help"
                    }
                ]
                {{ IF message.chat.id == config.telegram_admin.id }} ,
                [
                    {
                        "text": "üõ† –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å",
                        "callback_data": "/adminmenu"
                    }
                ]
                {{ END }} ,
                [
                    {
                        "text": "üîÑ –û–±–Ω–æ–≤–∏—Ç—å –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}

<% CASE '/balance' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{{ userlogs = user.services.list_for_api('usi', {}) }}
{{
    limit = 5;
    offset = args.1 || 0;
    userData = user.id(args.0);
    payData = userPay.comment.object;
    payMethod = payData.payment_method;
    payCard = payMethod.card;
    userPays = ref(userData.pays.list_for_api('limit', limit, 'offset', offset ));
}}
{{ last_payment = user.payments.last() }}
{{ forecast = user.pays.forecast }}
{{ user_services = ref(user.services.list_for_api('category', '%')) }}
{{ blocked_services = ref(user.services.list_for_api('category', '%', 'filter', { 'status' => 'BLOCK' })) }}
{{ expired_services = ref(user.services.list_for_api('category', '%', 'filter', { 'status' => 'NOT PAID' })) }}
{{ active_services = ref(user.services.list_for_api('category', '%', 'filter', { 'status' => 'ACTIVE' })) }}
{{ USE date }}

{
    "sendPhoto": {
        "photo": "{{ config.logo.url }}",
        "caption": "<blockquote>üí∞ <b>–ë–∞–ª–∞–Ω—Å:</b> {{ user.balance }} ‚ÇΩ\nüéÅ <b>–ë–æ–Ω—É—Å—ã:</b> {{ user.get_bonus }} ‚ÇΩ\nüîñ <b>–°–∫–∏–¥–∫–∞:</b> {{ user.discount }}%\nüë• <b>–ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ –¥—Ä—É–∑–µ–π:</b> {{ user.referrals_count }}\nüí≥ <b>–û–±—â–∏–π –¥–æ—Ö–æ–¥ –æ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤:</b> {{ user.get_bonus }} ‚ÇΩ\n\n‚è≥ <b>–°–ª–µ–¥—É—é—â–µ–µ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ:</b> {{ IF userlogs.expire }}{{ date.format(userlogs.expire, '%H:%M %d.%m.%Y') }}{{ ELSE }}–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ{{ END }}\nüíµ <b>–û–∂–∏–¥–∞–µ–º–∞—è –æ–ø–ª–∞—Ç–∞:</b> {{ forecast.total }} ‚ÇΩ\n\nüîí <b>–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:</b> ({{ blocked_services.size }})\n{{ FOR service IN blocked_services }}- {{ service.name }}\n{{ END }}\n\n‚ùó <b>–ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:</b> ({{ expired_services.size }})\n{{ FOR service IN expired_services }}- {{ service.name }}\n{{ END }}\n\n‚úÖ <b>–ê–∫—Ç–∏–≤–Ω—ã–µ —É—Å–ª—É–≥–∏:</b> ({{ active_services.size }})\n{{ IF active_services.size > 0 }}{{ FOR service IN active_services }}- {{ service.name }} (–¥–æ {{ date.format(service.expire, '%H:%M %d.%m.%Y') }})\n{{ END }}{{ ELSE }}–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —É—Å–ª—É–≥.{{ END }}\n\nüíµ <b>–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø–ª–∞—Ç–∏—Ç—å:</b> <b>{{ user.pays.forecast('blocked',1).total }} ‚ÇΩ</b></blockquote>",
		"parse_mode": "HTML",
        "reply_markup" : {
            "inline_keyboard": [
                [
                    {
                        "text": "‚úö –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å",
                        "web_app": {
                            "url": "{{ config.api.url }}/shm/v1/public/tg_payments_webapp?format=html&user_id={{ user.id }}"
                        }
                    }
                ],
                [
                    {
                        "text": "‚ò∞ –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π",
                        "callback_data": "/pays {{ userData.user_id }} {{ offset - limit }}"
                    }
                ],
                [
                    {
                        "text": "üåç –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",
                        "callback_data": "/servers"
                    }
                ],
                [
                    {
                        "text": "üîÑ –û–±–Ω–æ–≤–∏—Ç—å",
                        "callback_data": "/balance"
                    }
                ],
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}

<% CASE '/servers' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{{ vpn_mz_lt_servers = ref(user.services.list_for_api('category', 'vpn-mz-lt')) }}
{{ vpn_mz_usa_servers = ref(user.services.list_for_api('category', 'vpn-mz-usa')) }}
{{ vpn_mz_spain_servers = ref(user.services.list_for_api('category', 'vpn-mz-spain')) }}

{{ limit = 1 }}
{{ offset = args.0 || 0 }}

{
    "sendMessage": {
        "text": "<b>–°–µ—Ä–≤–µ—Ä–∞:</b>\n\n<b>vpn-mz-lt:</b>\n{{ IF vpn_mz_lt_servers.size > 0 }}{{ FOR server IN vpn_mz_lt_servers.slice(offset, limit) }}\nüåç –°–µ—Ä–≤–µ—Ä: {{ server.name }}\nüí° –°—Ç–∞—Ç—É—Å: {{ server.status }}\n‚è≥ –î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ: {{ server.expire }}\nüìä –¢—Ä–∞—Ñ–∏–∫: {{ server.traffic }}\nüè∑Ô∏è –°—Ç–æ–∏–º–æ—Å—Ç—å: {{ server.cost }} —Ä—É–±.\n{{ END }}{{ ELSE }}–ù–µ—Ç —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ vpn-mz-lt.\n{{ END }}\n\n<b>vpn-mz-usa:</b>\n{{ IF vpn_mz_usa_servers.size > 0 }}{{ FOR server IN vpn_mz_usa_servers.slice(offset, limit) }}\nüåç –°–µ—Ä–≤–µ—Ä: {{ server.name }}\nüí° –°—Ç–∞—Ç—É—Å: {{ server.status }}\n‚è≥ –î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ: {{ server.expire }}\nüìä –¢—Ä–∞—Ñ–∏–∫: {{ server.traffic }}\nüè∑Ô∏è –°—Ç–æ–∏–º–æ—Å—Ç—å: {{ server.cost }} —Ä—É–±.\n{{ END }}{{ ELSE }}–ù–µ—Ç —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ vpn-mz-usa.\n{{ END }}\n\n<b>vpn-mz-spain:</b>\n{{ IF vpn_mz_spain_servers.size > 0 }}{{ FOR server IN vpn_mz_spain_servers.slice(offset, limit) }}\nüåç –°–µ—Ä–≤–µ—Ä: {{ server.name }}\nüí° –°—Ç–∞—Ç—É—Å: {{ server.status }}\n‚è≥ –î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ: {{ server.expire }}\nüìä –¢—Ä–∞—Ñ–∏–∫: {{ server.traffic }}\nüè∑Ô∏è –°—Ç–æ–∏–º–æ—Å—Ç—å: {{ server.cost }} —Ä—É–±.\n{{ END }}{{ ELSE }}–ù–µ—Ç —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ vpn-mz-spain.\n{{ END }}",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üîÑ –û–±–Ω–æ–≤–∏—Ç—å",
                        "callback_data": "/servers {{ offset }}"
                    }
                ],
                [
                    {{ IF offset > 0 }}
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
                        "callback_data": "/servers {{ offset - limit }}"
                    },
                    {{ END }}
                    {{ IF vpn_mz_lt_servers.size > limit || vpn_mz_usa_servers.size > limit || vpn_mz_spain_servers.size > limit }}
                    {
                        "text": "–ï—â—ë ‚û°Ô∏è",
                        "callback_data": "/servers {{ offset + limit }}"
                    }
                    {{ END }}
                ],
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/balance"
                    }
                ]
            ]
        }
    }
}

<% CASE '/pays' %>
{
    "sendPhoto": {
        "photo": "{{ config.logo.url }}",
        "caption": "‚ò∞ <b>–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π</b>",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                {{
                    limit = 7;
                    offset = args.0 || 0;
                    offset = (offset < 0) ? 0 : offset;
                    pays = ref(user.pays.list_for_api('limit', limit, 'offset', offset));
                }}
                {{ IF pays.size > 0 }}
                    {{ FOR item in pays }}
                    {{ TEXT = BLOCK }}
üìÖ –î–∞—Ç–∞: {{ USE date }}{{ date.format(item.date, '%d.%m.%Y') }}  
üí∞ –°—É–º–º–∞: {{ item.money }} ‚ÇΩ
                    {{ END }}
                    [
                        {
                            "text": "{{ TEXT.replace('\n',' ') }}",
                            "callback_data": "/checkpay {{ item.id }}"
                        }
                    ],
                    {{ END }}
                {{ ELSE }}
                    [
                        {
                            "text": "‚ùóÔ∏è –ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –æ –ø–ª–∞—Ç–µ–∂–∞—Ö.",
                            "callback_data": "/menu"
                        }
                    ],
                {{ END }}
                {{ IF pays.size == limit || offset > 0 }}
                [
                    {{ IF offset > 0 }}
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
                        "callback_data": "/pays {{ offset - limit }}"
                    },
                    {{ END }}
                    {{ IF pays.size == limit }}
                    {
                        "text": "‚û°Ô∏è –î–∞–ª–µ–µ",
                        "callback_data": "/pays {{ offset + limit }}"
                    }
                    {{ END }}
                ],
                {{ END }}
                [
                    {
                        "text": "üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}

<% CASE '/checkpay' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{{
    userPay = ref(pay.list_for_api('limit', 1, 'filter', {"id" = args.0})).first;
    payData = userPay.comment.object;
    payMethod = payData.payment_method;
    payCard = payMethod.card;
    userData = user.id(userPay.user_id);
}}
{{ TEXT = BLOCK }}
üí∏ <b>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–ª–∞—Ç–µ–∂–µ</b>
üÜî <b>ID –ø–ª–∞—Ç–µ–∂–∞:</b> {{ userPay.id }}
üë§ <b>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</b> {{ userData.full_name.replace('"', '"') }} ({{ userData.user_id }})

üìÖ <b>–î–∞—Ç–∞ –ø–ª–∞—Ç–µ–∂–∞:</b> {{ userPay.date }}
üí≥ <b>–ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:</b> {{ userPay.pay_system_id }}
üí∞ <b>–°—É–º–º–∞:</b> {{ userPay.money }} —Ä—É–±.

{{ IF userPay.telegram_bot == 'telegram_bot' }}
‚≠ê <b>–û–ø–ª–∞—Ç–∞ –∑–≤–µ–∑–¥–∞–º–∏:</b> {{ userPay.currency }}
{{ END }}

{{ IF userPay.currency == 'XTR' }}
‚≠ê <b>–û–ø–ª–∞—Ç–∞ –∑–≤–µ–∑–¥–∞–º–∏:</b> {{ userPay.currency }}
{{ END }}

{{ IF userPay.comment.comment }}
üìù <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –ø–ª–∞—Ç–µ–∂—É:</b>
<blockquote>{{ userPay.comment.comment }}</blockquote>
{{ END }}

{{ IF payData }}
üìÇ <b>–î–µ—Ç–∞–ª–∏ –ø–ª–∞—Ç–µ–∂–∞:</b>
<blockquote> üÜî <b>ID –≤ —Å–∏—Å—Ç–µ–º–µ:</b> {{ payData.id }}
üìä <b>–°—Ç–∞—Ç—É—Å:</b> {{ payData.status }}
{{ IF payCard }}
–¢–∏–ø –∫–∞—Ä—Ç—ã: {{ payCard.card_type }}
–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã: {{ payCard.first6 }}******{{ payCard.last4 }}
–ë–∞–Ω–∫: {{ payCard.issuer_name }}
–°—Ç—Ä–∞–Ω–∞ –±–∞–Ω–∫–∞: {{ payCard.issuer_country }}
–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: {{ payCard.expiry_month }}/{{ payCard.expiry_year }}
{{ END }}
{{ IF payMethod.type == 'sbp' }}
–¢–∏–ø –æ–ø–ª–∞—Ç—ã: –°–ë–ü
–ù–æ–º–µ—Ä –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –°–ë–ü: {{ payMethod.sbp_operation_id }}
–ë–∏–∫ –ë–∞–Ω–∫–∞: {{ payMethod.payer_bank_details.bic }}
{{ END }}

{{ IF payMethod.title.match('YooMoney') }}
–ö–æ—à–µ–ª–µ–∫ YooMoney: {{ payMethod.title }}
ID –∫–æ—à–µ–ª—å–∫–∞: {{ payMethod.account_number }}
{{ END }}
</blockquote>
{{ END }}

{{ END }}

{
    "sendMessage": {
        "text": "{{ TEXT.replace('\n','\n') }}\n",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üîÑ –û–±–Ω–æ–≤–∏—Ç—å",
                        "callback_data": "/checkpay {{ args.0 }}"
                    }
                ],
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥ ‚á¶",
                        "callback_data": "/pays"
                    }
                ]
            ]
        }
    }
}


<% CASE '/list' %>
{{ hasnotpaidus = ref(user.services.list_for_api('category', '%', 'filter', { 'status' => 'NOT PAID' } )).size }}
{{ hasblocked = ref(user.services.list_for_api('category', '%', 'filter', { 'status' => 'BLOCK' } )).size }}
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{{
    us = user.services.list_for_api('usi', args.0);
    USE date;
}}
{{ TEXT = BLOCK }}
‚≠êÔ∏è <b>–í–∞—à ID:</b> {{ user.id }} ‚≠êÔ∏è

üí° <i>–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤–∞—à–µ–º –∫–ª—é—á–µ, –ø—Ä–æ—Å—Ç–æ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∏–∂–µ.</i>

‚ùáÔ∏è <b>–î–ª—è –ø—Ä–æ–¥–ª–µ–Ω–∏—è –∏–ª–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∫–ª—é—á–∞:</b> –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å. –í–∞—à–∏ –∫–ª—é—á–∏ –±—É–¥—É—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã.

üîë <b>–í–∞—à–∏ —Ç–µ–∫—É—â–∏–µ –∫–ª—é—á–∏:</b>
{{ END }}

{
    "sendPhoto": {
        "photo": "{{ config.logo.url }}",
        "parse_mode": "HTML",
        "caption": "{{ TEXT.replace('\n','\n') }}\n",
        "reply_markup": {
            "inline_keyboard": [
                {{ FOR item IN ref( user.services.list_for_api( 'category', '%' ) ) }}
                {{ SWITCH item.status }}
                  {{ CASE 'ACTIVE' }}
                  {{ icon = '‚úÖ' }}
                  {{ status = ' –†–∞–±–æ—Ç–∞–µ—Ç' }}
                  {{ CASE 'BLOCK' }}
                  {{ icon = '‚ùå' }}
                  {{ status = ' –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞' }}
                  {{ CASE 'NOT PAID' }}
                  {{ icon = 'üí∞' }}
                  {{ status = ' –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã' }}
                  {{ CASE }}
                  {{ icon = '‚è≥' }}
                  {{ status = ' –û–±—Ä–∞–±–æ—Ç–∫–∞' }}
                {{ END }}
                [
                    {
                        "text": "‚Ññ{{ item.user_service_id }} - {{ item.name }} - {{ icon }} {{ status }}",
                        "callback_data": "/service {{ item.user_service_id }}"
                    }
                ],
                {{ END }}
                [
                    {
                        "text": "üõí –ö—É–ø–∏—Ç—å –Ω–æ–≤—ã–π –∫–ª—é—á üõí",
                        {{ IF hasnotpaidus > 0 || hasblocked > 0 }}
                            "callback_data": "/hint"
                        {{ ELSE }}
                            "callback_data": "/pricelist"
                        {{ END }}
                    }
                ],
                [
                    {
                        "text": "üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ üîÑ",
                        "callback_data": "/list"
                    }
                ],
                [
                    {
                        "text": "üîå –ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫–ª—é—á? üîå",
                        "url": "https://telegra.ph/Instrukciya-dlya-iPhoneiPad-11-27"
                    }
                ],
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é ‚á¶",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}


<% CASE '/hint' %>
{
    "sendMessage": {
        "chat_id": {{ message.chat.id }},
        "parse_mode": "HTML",
        "text": "‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ!** –ß—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –æ–¥–Ω–æ –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π:\n\n1Ô∏è‚É£ –û–ø–ª–∞—Ç–∏—Ç–µ  üí≥  –≤—Å–µ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏.\n2Ô∏è‚É£ –£–¥–∞–ª–∏—Ç–µ  üóëÔ∏è  –≤—Å–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏.\n\n–≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤–∞—à–µ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏. –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–Ω–∏–º–∞–Ω–∏–µ! üôè",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "–ü–µ—Ä–µ–π—Ç–∏ –≤ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}

<% CASE '/service' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{{ item = us.id(args.0) }}
{{ 
    us = user.services.list_for_api('usi', args.0);
    USE date;
}}
{{ EXPIRE = BLOCK }}
    {{ USE date }}
    {{ date_sec = date.now }}
    {{ expire_sec = date.format(us.expire, '%s') }}
    {{ days_left = (expire_sec - date_sec) div 86400 }}
    {{ months = days_left div 30 }}
    {{ days = days_left % 30 }}
        {{ IF months == 0 }}
            {{ IF days == 1 }} 1 –¥–µ–Ω—å
            {{ ELSIF days == 2 or days == 3 or days == 4 }} {{ days }} –¥–Ω—è
            {{ ELSE }} {{ days }} –¥–Ω–µ–π
            {{ END }}
        {{ ELSE }}
            {{ IF months == 1 }}1 –º–µ—Å—è—Ü - 
            {{ ELSIF months == 2 or months == 3 or months == 4 }}{{ months }} –º–µ—Å—è—Ü–∞ - 
            {{ ELSE }}{{ months }} –º–µ—Å—è—Ü–µ–≤ - 
            {{ END }}
            {{ IF days > 0 }}
                {{ IF days == 1 }} 1 –¥–µ–Ω—å
                {{ ELSIF days == 2 or days == 3 or days == 4 }} {{ days }} –¥–Ω—è
                {{ ELSE }} {{ days }} –¥–Ω–µ–π
                {{ END }}
            {{ END }}
        {{ END }}
{{ END }}
{{ sub_url = storage.read('name','vpn_mrzb_' _ args.0 ).subscription_url }}
{{ bytes = http.get("$sub_url/info").used_traffic }}
{{ gb = bytes / 1073741824 FILTER format("%.0f") }}
{{ mb = (bytes % 1073741824) / 1048576 FILTER format("%.0f") }}
{
    "sendPhoto": {
        {{ SWITCH us.status }}
  {{ CASE 'ACTIVE' }}
  {{ icon = '‚úÖ' }}
  {{ status = '–†–∞–±–æ—Ç–∞–µ—Ç' }}
  {{ CASE 'BLOCK' }}
  {{ icon = 'üö´' }}
  {{ status = '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞' }}
  {{ CASE 'NOT PAID' }}
  {{ icon = 'üí≥' }}
  {{ status = '–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã' }}
  {{ CASE }}
  {{ icon = '‚è≥' }}
  {{ status = '–û–±—Ä–∞–±–æ—Ç–∫–∞' }}
{{ END }}
{{ TEXT = BLOCK }}
<b>üîë –£—Å–ª—É–≥–∞: #<b>{{ us.user_service_id }}</b> - <code>{{ us.name }}</code></b>
    {{ IF us.expire }}
<b>üóìÔ∏è –û–ø–ª–∞—á–µ–Ω–∞ –¥–æ</b>: {{ date.format(us.expire, '%d.%m.%Y') }}
    {{ END }}
<b>üìä –°—Ç–∞—Ç—É—Å</b>: {{ icon }} {{ status }}
{{ IF us.next != us.service_id && us.next > 0 }}
<b>–°–ª–µ–¥—É—é—â–∏–π —Ç–∞—Ä–∏—Ñ –∫–ª—é—á–∞</b>: {{ service.id(us.next).name }}
{{ END }}
    {{ IF mb == 0 }}
    {{ ELSE}}
        {{ IF gb >= 1 }}
üìà –ò–∑—Ä–∞—Å—Ö–æ–¥–æ–≤–∞–Ω–æ —Ç—Ä–∞—Ñ–∏–∫–∞: {{ gb }} Gb.{{ mb }} Mb
        {{ ELSE }}
üìà –ò–∑—Ä–∞—Å—Ö–æ–¥–æ–≤–∞–Ω–æ —Ç—Ä–∞—Ñ–∏–∫–∞: {{ mb }} Mb
        {{ END }}
    {{ END }}
{{ END }}
        "photo": "https://vpnbot.pro/images/DALL-E-2024-11-30-19-58.jpg",
        "caption": "{{ TEXT.replace('\n','\n') }}\nüìÖ –û—Å—Ç–∞–ª–æ—Å—å: {{ EXPIRE }}",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                {{ IF us.status == 'ACTIVE' }}
                {{ subscription_url = storage.read('name', 'vpn_mrzb_' _ args.0).subscription_url }}
                {{ IF us.category.grep('^(vpn-mz-lt|vpn-mz-usa|vpn-mz-spain)').first }}
                {{ IF subscription_url.grep('^https:').first }}
                [
                    {
                        "text": "üîó –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è",
                        "web_app": {
                            "url": "{{ config.api.url }}/shm/v1/template/subscriptions_link?format=html&session_id={{ user.gen_session.id }}&uid={{ user.id }}&us_id={{ args.0 }}"
                        }
                    }
                ],
				[
                    {
                        "text": "üîÑ –°–º–µ–Ω–∏—Ç—å —Ç–∞—Ä–∏—Ñ",
                        "callback_data": "/change {{ args.0 }}"
                    }
                ],
                {{ ELSE }}
                [
                    {
                        "text": "‚ö†Ô∏è –û–®–ò–ë–ö–ê: –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ SSL –¥–ª—è Marzban",
                        "callback_data": "/menu"
                    }
                ],
                {{ END }}
                {{ ELSE }}
                [
                    {
                        "text": "üóù –°–∫–∞—á–∞—Ç—å –∫–ª—é—á",
                        "callback_data": "/download_qr {{ args.0 }}"
                    },
                    {
                        "text": "üëÅ –ü–æ–∫–∞–∑–∞—Ç—å QR –∫–æ–¥",
                        "callback_data": "/show_qr {{ args.0 }}"
                    }
                ],
                {{ END }}
                {{ END }}
				{{ IF us.next == '-1' }}
                [
                    {
                        "text": "‚ùå –ê–≤—Ç–æ-–ø—Ä–æ–¥–ª–µ–Ω–∏–µ –≤—ã–∫–ª—é—á–µ–Ω–æ",
                        "callback_data": "/renewal {{args.0}}"
                    }
                ],
				{{ ELSE }}
                [
                    {
                        "text": "‚úÖ –ê–≤—Ç–æ-–ø—Ä–æ–¥–ª–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ",
                        "callback_data": "/renewal {{args.0}}"
                    }
                ],
                {{ END }}
                  {{ IF us.status == 'NOT PAID' || us.status == 'BLOCK' }}
                [
                    {
                        "text": "üí≥ –û–ø–ª–∞—Ç–∏—Ç—å —Å–µ–π—á–∞—Å",
                        "callback_data": "/balance {{ user.pays.forecast('blocked', 1).total }}"
                    }
                ],
				[
                    {
                        "text": "üîÑ –°–º–µ–Ω–∏—Ç—å —Ç–∞—Ä–∏—Ñ",
                        "callback_data": "/change {{ args.0 }}"
                    }
                ],
                {{ END }}
                {{ IF us.status != 'PROGRESS' }}
                [
                    {
                        "text": "üóë –£–¥–∞–ª–∏—Ç—å —É—Å–ª—É–≥—É",
                        "callback_data": "/delete {{ args.0 }}"
                    }
                ],
                {{ END }}
                [
                    {
                        "text": "üîç –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ VPN",
                        "callback_data": "/xray"
                    }
                ],
                [
                    {
                        "text": "üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫",
                        "callback_data": "/service {{ args.0 }}"
                    }
                ],
                [
                    {
                        "text": "‚Ü©Ô∏è –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É —É—Å–ª—É–≥",
                        "callback_data": "/list"
                    }
                ]
            ]
        }
    }
}

<% CASE '/change' %>
{
    "sendMessage": {
        "parse_mode": "HTML",
        "text": "üìã **–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ –¥–ª—è —Å–º–µ–Ω—ã:**\n\nüîÑ –í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –æ–¥–∏–Ω –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤ –Ω–∏–∂–µ. –¶–µ–Ω—ã —É–∫–∞–∑–∞–Ω—ã –≤ —Ä—É–±–ª—è—Ö (‚ÇΩ).",
        "reply_markup": {
            "inline_keyboard": [
                {{ FOR item IN ref(service.api_price_list( 'category', 'vpn-%' )).nsort('cost') }}
                    [
                        {
                            "text": "üíº {{ item.name }} ‚Äî {{ item.cost }} ‚ÇΩ",
                            "callback_data": "/change_id {{ args.0 _ ' ' _ item.service_id }}"
                        }
                    ],
                {{ END }}
                [
                    {
                        "text": "üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}

<% CASE '/change_id' %>
{{ change = us.id( args.0 ).change( service_id = args.1 ) }}
{{ TEXT = BLOCK }}
üéâ <b>–¢–∞—Ä–∏—Ñ —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω—ë–Ω!</b> üöÄ

üìù <b>–í–∞—à –Ω–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ:</b>  
{{ FOR item IN ref(service.list_for_api('service_id', args.1 )) }}
üîπ <b>{{ item.name }}</b>
{{ END }}

‚úÖ <b>–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ!</b>

{{ IF user.pays.forecast('blocked',1).total > 0 }}
üí≥ <b>–î–æ–ø–ª–∞—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞!</b>  
–î–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–ø–ª–∞—Ç–∏—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –ø–æ –Ω–æ–≤–æ–º—É —Ç–∞—Ä–∏—Ñ—É.  
üí° –û—Å—Ç–∞—Ç–æ–∫ —Å—É–º–º—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ç–∞—Ä–∏—Ñ–∞ –±—É–¥–µ—Ç —É—á—Ç—ë–Ω.  
üíµ <b>–°—É–º–º–∞ –∫ –¥–æ–ø–ª–∞—Ç–µ:</b> <code>{{ user.pays.forecast('blocked', 1).total }}‚ÇΩ</code>

{{ us.finish('money_back', 1) }}
{{ END }}
{{ END }}
{
    "sendMessage": {
        "text": "{{ TEXT.replace('\n','\n') }}",
        "parse_mode": "HTML",
        "reply_markup" : {
            "inline_keyboard": [
                [
                    {
                        "text": "üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}



<% CASE '/renewal' %>
{{ us = us.id(args.0) }}
{{ IF us.next == '-1' }}
    {{ tkas = us.set('next',) }}
    {{ renewal_status = "‚úÖ –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –≤–∫–ª—é—á–µ–Ω–æ!" }}
    {{ renewal_hint = "–¢–µ–ø–µ—Ä—å —É—Å–ª—É–≥–∞ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–¥–ª–µ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ." }}
{{ ELSE }}
    {{ tkas = us.set('next', -1) }}
    {{ renewal_status = "‚ùå –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ!" }}
    {{ renewal_hint = "–£—Å–ª—É–≥–∞ –±–æ–ª—å—à–µ –Ω–µ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–¥–ª–µ–≤–∞—Ç—å—Å—è. –í—ã —Å–º–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–ª–∏—Ç—å –µ—ë –≤—Ä—É—á–Ω—É—é." }}
{{ END }}
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "üîÑ <b>–°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏—è</b>\n\n{{ renewal_status }}\n\n‚ÑπÔ∏è {{ renewal_hint }}",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "‚¨ÖÔ∏è –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —É—Å–ª—É–≥–µ",
                        "callback_data": "/service {{ args.0 }}"
                    }
                ]
            ]
        }
    }
}
<% CASE '/pricelist' %>

{{ hasnotpaidus = ref(user.services.list_for_api('category', '%', 'filter', { 'status' => 'NOT PAID' } )).size }}
{{ hasblocked = ref(user.services.list_for_api('category', '%', 'filter', { 'status' => 'BLOCK' } )).size }}
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{{ TEXT = BLOCK }}
‚ò∑ <b>–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π —Ö–æ—Ç–∏—Ç–µ –∑–∞–∫–∞–∑–∞—Ç—å —Ç–∞—Ä–∏—Ñ–Ω—ã–π –ø–ª–∞–Ω:</b>

<i>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä–∞–Ω—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã.</i>
{{ END }}
{
    "sendMessage": {
        "text": "{{ TEXT.replace('\n','\n') }}\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                {{ FOR country IN ["USA", "SPAIN", "LT", "FRANCE", "GERMANY"] }}
                    [
                        {
                            "text":
                                {{ IF country == 'USA' }} "üá∫üá∏ –°–®–ê"
                                {{ ELSE }}
                                    {{ IF country == 'SPAIN' }} "üá™üá∏ –ò—Å–ø–∞–Ω–∏—è"
                                    {{ ELSE }}
                                        {{ IF country == 'LT' }} "üá±üáπ –õ–∏—Ç–≤–∞"
                                        {{ ELSE }}
                                            {{ IF country == 'FRANCE' }} "üá´üá∑ –§—Ä–∞–Ω—Ü–∏—è"
                                            {{ ELSE }} "üá©üá™ –ì–µ—Ä–º–∞–Ω–∏—è" {{ END }}
                                        {{ END }}
                                    {{ END }}
                                {{ END }},
                            {{ IF hasnotpaidus > 0 || hasblocked > 0 }}
                                "callback_data": "/hint"
                            {{ ELSE }}
                                "callback_data": "/location {{ country }}"
                            {{ END }}
                        }
                    ],
                {{ END }}
                [
                    {
                        "text": "‚Ü©Ô∏è –ù–∞–∑–∞–¥ –∫ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}

<% CASE '/location' %>
{{ selected_location = args.0 }}
{{ hasnotpaidus = ref(user.services.list_for_api('category', '%', 'filter', { 'status' => 'NOT PAID' } )).size }}
{{ hasblocked = ref(user.services.list_for_api('category', '%', 'filter', { 'status' => 'BLOCK' } )).size }}
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{{ TEXT = BLOCK }}
üåç **–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ –¥–ª—è –ª–æ–∫–∞—Ü–∏–∏: {{ selected_location }}**

<i>–ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –≥–∏–±–∫–∏–µ —Ç–∞—Ä–∏—Ñ—ã —Å —Ä–∞–∑–Ω—ã–º–∏ —Å—Ä–æ–∫–∞–º–∏ –¥–µ–π—Å—Ç–≤–∏—è. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–ª–∞–Ω:</i>
{{ END }}
{
    "sendMessage": {
        "text": "{{ TEXT.replace('\n','\n') }}\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                {{ IF selected_location == 'LT' }}
                    {{ FOR item IN ref(service.api_price_list).nsort('service_id') }}
                        {{ IF item.category == 'vpn-mz-lt' }}
                            [
                                {
                                    "text": "üìÖ {{ item.name }} ‚Äî {{ item.cost }} —Ä—É–±/–º–µ—Å",
                                    {{ IF hasnotpaidus > 0 || hasblocked > 0 }}
                                        "callback_data": "/hint"
                                    {{ ELSE }}
                                        "callback_data": "/serviceorder {{ item.service_id }} LT 1"
                                    {{ END }}
                                }
                            ],
                            [
                                {
                                    "text": "üìÖ {{ item.name }} - 6 –º–µ—Å –∑–∞ {{ item.cost * 6 }} —Ä—É–±.",
                                    {{ IF hasnotpaidus > 0 || hasblocked > 0 }}
                                        "callback_data": "/hint"
                                    {{ ELSE }}
                                        "callback_data": "/serviceorder {{ item.service_id }} LT 6"
                                    {{ END }}
                                }
                            ],
                            [
                                {
                                    "text": "üìÖ {{ item.name }} - 12 –º–µ—Å –∑–∞ {{ item.cost * 12 }} —Ä—É–±.",
                                    {{ IF hasnotpaidus > 0 || hasblocked > 0 }}
                                        "callback_data": "/hint"
                                    {{ ELSE }}
                                        "callback_data": "/serviceorder {{ item.service_id }} LT 12"
                                    {{ END }}
                                }
                            ],
                        {{ END }}
                    {{ END }}
                {{ END }}

                {{ IF selected_location == 'USA' }}
                    {{ FOR item IN ref(service.api_price_list).nsort('service_id') }}
                        {{ IF item.category == 'vpn-mz-usa' }}
                            [
                                {
                                    "text": "üìÖ {{ item.name }} ‚Äî {{ item.cost }} —Ä—É–±/–º–µ—Å",
                                    {{ IF hasnotpaidus > 0 || hasblocked > 0 }}
                                        "callback_data": "/hint"
                                    {{ ELSE }}
                                        "callback_data": "/serviceorder {{ item.service_id }} USA 1"
                                    {{ END }}
                                }
                            ],
                            [
                                {
                                    "text": "üìÖ {{ item.name }} - 6 –º–µ—Å –∑–∞ {{ item.cost * 6 }} —Ä—É–±.",
                                    {{ IF hasnotpaidus > 0 || hasblocked > 0 }}
                                        "callback_data": "/hint"
                                    {{ ELSE }}
                                        "callback_data": "/serviceorder {{ item.service_id }} USA 6"
                                    {{ END }}
                                }
                            ],
                            [
                                {
                                    "text": "üìÖ {{ item.name }} - 12 –º–µ—Å –∑–∞ {{ item.cost * 12 }} —Ä—É–±.",
                                    {{ IF hasnotpaidus > 0 || hasblocked > 0 }}
                                        "callback_data": "/hint"
                                    {{ ELSE }}
                                        "callback_data": "/serviceorder {{ item.service_id }} USA 12"
                                    {{ END }}
                                }
                            ],
                        {{ END }}
                    {{ END }}
                {{ END }}

                {{ IF selected_location == 'SPAIN' }}
                    {{ FOR item IN ref(service.api_price_list).nsort('service_id') }}
                        {{ IF item.category == 'vpn-mz-spain' }}
                            [
                                {
                                    "text": "üìÖ {{ item.name }} ‚Äî {{ item.cost }} —Ä—É–±/–º–µ—Å",
                                    {{ IF hasnotpaidus > 0 || hasblocked > 0 }}
                                        "callback_data": "/hint"
                                    {{ ELSE }}
                                        "callback_data": "/serviceorder {{ item.service_id }} SPAIN 1"
                                    {{ END }}
                                }
                            ],
                            [
                                {
                                    "text": "üìÖ {{ item.name }} - 6 –º–µ—Å –∑–∞ {{ item.cost * 6 }} —Ä—É–±.",
                                    {{ IF hasnotpaidus > 0 || hasblocked > 0 }}
                                        "callback_data": "/hint"
                                    {{ ELSE }}
                                        "callback_data": "/serviceorder {{ item.service_id }} SPAIN 6"
                                    {{ END }}
                                }
                            ],
                            [
                                {
                                    "text": "üìÖ {{ item.name }} - 12 –º–µ—Å –∑–∞ {{ item.cost * 12 }} —Ä—É–±.",
                                    {{ IF hasnotpaidus > 0 || hasblocked > 0 }}
                                        "callback_data": "/hint"
                                    {{ ELSE }}
                                        "callback_data": "/serviceorder {{ item.service_id }} SPAIN 12"
                                    {{ END }}
                                }
                            ],
                        {{ END }}
                    {{ END }}
                {{ END }}

                [
                    {
                        "text": "‚Ü©Ô∏è –ù–∞–∑–∞–¥",
                        "callback_data": "/pricelist"
                    }
                ]
            ]
        }
    }
}

<% CASE '/serviceorder' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "shmServiceOrder": {
        "service_id": "{{ args.0 }}",
        "callback_data": "/list",
        "cb_not_enough_money": "/menu",
        "error": "‚ùóÔ∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ –ø–æ–∑–∂–µ. –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É."
    }
},
{
    "answerCallbackQuery": {
         "callback_query_id": {{ callback_query.id }},
         "parse_mode":"HTML",
         "text": "‚úÖ –ö–ª—é—á –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω.",
         "show_alert": true
     }
}

<% CASE '/notifications_active' %>
{{ item = us.id( args.0 ) }}
{{ subscription_url = storage.read('name','vpn_mrzb_' _ args.0 ).subscription_url }}
{{ TEXT = BLOCK }}
üéâ <b>üéä –£—Å–ª—É–≥–∞ —É—Å–ø–µ—à–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞!</b> üöÄ  

<b>üîπ –ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏:</b> <code>{{ item.name }}</code>
<b>üîπ ID —É—Å–ª—É–≥–∏:</b>  ‚Ññ <code>{{ item.user_service_id }}</code>
<b>‚úÖ –°—Ç–∞—Ç—É—Å:</b> –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞

<b>üìÖ –î–∞—Ç–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:</b> {{ USE date }}{{ date.format( item.created, '%d.%m.%Y–≥. %H:%M') }}
<b>‚è≥ –î–æ:</b> {{ USE date }}{{ date.format( item.expire, '%d.%m.%Y–≥. %H:%M') }}

<b>üëâ –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∫–Ω–æ–ø–∫–µ –Ω–∏–∂–µ.</b>
{{ END }}
{
    "sendMessage": {
        "text": "{{ TEXT.replace('\n','\n') }}\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üöÄ –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏",
                        "web_app": {
                            "url": "{{ config.api.url }}/shm/v1/template/subscriptions_link?format=html&session_id={{ user.gen_session.id }}&uid={{ user.id }}&us_id={{ args.0 }}"
                        }
                    }
                ],
                [
                    {
                        "text": "üè† –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é",
                        "callback_data": "/start"
                    }
                ]
            ]
        }
    }
}

<% CASE '/notifications_block' %>
{{ item = us.id( args.0 ) }}
{{ subscription_url = storage.read('name','vpn_mrzb_' _ args.0 ).subscription_url }}
{{ IF event_name == "BLOCK" }}
{{ TEXT = BLOCK }}
<b>üö´ –í–Ω–∏–º–∞–Ω–∏–µ! –í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞!</b>

<b>üîπ –ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏:</b> <code>{{ item.name }}</code>
<b>üîπ ID —É—Å–ª—É–≥–∏:</b> ‚Ññ <code>{{ item.user_service_id }}</code>
<b>‚ö†Ô∏è –°—Ç–∞—Ç—É—Å:</b> –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞

<b>üí∞ –°—É–º–º–∞ –∫ –æ–ø–ª–∞—Ç–µ:</b> <i>{{ user.pays.forecast('blocked', 1).total }}‚ÇΩ</i>

<b>‚ùó –ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:</b> <i>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ —Å—á–µ—Ç–µ. –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ.</i> üí≥

<b>üëâ –î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø–æ–ª–Ω–∏—Ç–µ —Å—á–µ—Ç –∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞—à–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π.</b>
{{ END }}
{{ END }}

{
    "sendMessage": {
        "text": "{{ TEXT.replace('\n','\n') }}\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üè† –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é",
                        "callback_data": "/start"
                    }
                ]
            ]
        }
    }
}

<% CASE '/delete' %>
{{
  us = user.service.list_for_api('usi', args.0);
}}
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "ü§î <b>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ –∫–ª—é—á–∞ #{{ args.0 }}. –ö–ª—é—á –Ω–µ–ª—å–∑—è –±—É–¥–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å!</b>",
        "reply_markup" : {
            "inline_keyboard": [
                [
                    {
                        "text": "üß® –î–ê, –£–î–ê–õ–ò–¢–¨! üî•",
                        "callback_data": "/delete_confirmed {{ args.0 }}"
                    }
                ],

                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/list"
                    }
                ]
            ]
        }
    }
}

<% CASE '/delete_confirmed' %>
{
    "deleteMessage": { 
        "message_id": "{{ message.message_id }}" 
    }
},
{
    "shmServiceDelete": {
        "usi": "{{ args.0 }}",
        "callback_data": "/list",
        "error": "–û–®–ò–ë–ö–ê"
    }
},
{
    "answerCallbackQuery": {
        "callback_query_id": "{{ callback_query.id }}",
        "parse_mode": "HTML",
        "text": "–í–∞—à –∫–ª—é—á —É–¥–∞–ª—è–µ—Ç—Å—è...",
        "show_alert": true
    }
}


<% CASE '/referrals' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "ü§ù <b>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à—É —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É!</b>\n\n–ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π—Ç–µ <b>{{ config.billing.partner.income_percent }}% –æ—Ç –∫–∞–∂–¥–æ–≥–æ –∏—Ö –ø–ª–∞—Ç–µ–∂–∞</b>.\n\nüîó <b>–í–∞—à–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞:</b>\n<code>{{ config.tg_bot.url }}?start={{ toBase64Url(toQueryString( partner_id = user.id )) }}</code>\n\n–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å—Å—ã–ª–∫–æ–π —Å –¥—Ä—É–∑—å—è–º–∏!\n\n",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π",
                        "switch_inline_query": "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ {{ config.company.name }} –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π —Å –Ω–∞–º–∏! üõ° {{ config.tg_bot.url }}?start={{ user.id }}"
                    }
                ],
                [
                    {
                        "text": "üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∞—à–∏—Ö –¥–æ—Ö–æ–¥–æ–≤",
                        "callback_data": "/referral_stats"
                    },
                    {
                        "text": "‚ùì –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?",
                        "callback_data": "/referral_help"
                    }
                ],
				[
                    {
                        "text": "üì§ –°–ø–∏—Å–æ–∫ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã—Ö",
                        "callback_data": "/ref_list"
                    }
                ],
                [
                    {
                        "text": "üîô –ù–∞–∑–∞–¥",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}

<% CASE '/ref_list' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{{
    limit = 5;
    offset = (args.0 || 0);
    referralsArray = ref(user.list_for_api('limit', limit, 'offset', offset, 'filter', {"partner_id": user.id}));
}}

{
    "sendMessage": {
        "text": "üìÉ <b>–í–∞—à–∏ –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</b>\n\nüë• <b>–í—Å–µ–≥–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–æ:</b> {{ user.referrals_count }}\n\n{{ IF referralsArray.size > 0 }}{{ FOR referral IN referralsArray }}üë§ <b>–ò–º—è:</b> {{ referral.full_name }}\nüìÖ <b>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</b> {{ referral.registration_date }}\nüíº <b>–°—Ç–∞—Ç—É—Å:</b> {{ referral.status }}\n\n{{ END }}{{ ELSE }}–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.\n{{ END }}",
         "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üîÑ –û–±–Ω–æ–≤–∏—Ç—å",
                        "callback_data": "/ref_list {{ offset }}"
                    }
                ],
                [
                    {{ IF offset > 0 }}
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
                        "callback_data": "/ref_list {{ offset - limit }}"
                    },
                    {{ END }}
                    {{ IF referralsArray.size == limit }}
                    {
                        "text": "–ï—â—ë ‚û°Ô∏è",
                        "callback_data": "/ref_list {{ offset + limit }}"
                    }
                    {{ END }}
                ],
                [
                    {
                        "text": "üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}


<% CASE '/referral_stats' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "üìä <b>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∞—à–µ–π —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã</b>\n\nüë• <b>–ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ –¥—Ä—É–∑–µ–π:</b> {{ user.referrals_count }}\nüí≥ <b>–û–±—â–∏–π –¥–æ—Ö–æ–¥ –æ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤:</b> {{ user.get_bonus }} —Ä—É–±.\n\nüîó <b>–í–∞—à–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞:</b>\n<code>{{ config.tg_bot.url }}?start={{ user.id }}</code>\n\nüìà <b>–ö–∞–∫ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ—Ö–æ–¥?</b>\n–ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –±–æ–ª—å—à–µ –¥—Ä—É–∑–µ–π! –ö–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤–∞—à—É –ø—Ä–∏–±—ã–ª—å, –∞ —Ç–∞–∫–∂–µ –ø–æ–º–æ–≥–∞–µ—Ç –≤–∞—à–∏–º –¥—Ä—É–∑—å—è–º –æ—Ç–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø –∫ –Ω–∞—à–µ–º—É –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–º—É —Å–µ—Ä–≤–∏—Å—É.",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π",
                        "switch_inline_query": "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ {{ config.company.name }} –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π —Å –Ω–∞–º–∏! üõ° {{ config.tg_bot.url }}?start={{ user.id }}"
                    }
                ],
                [
                    {
                        "text": "‚ùì –£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ –æ –ø—Ä–æ–≥—Ä–∞–º–º–µ",
                        "callback_data": "/referral_help"
                    },
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}

<% CASE '/referral_help' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "üîç <b>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞—à–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞?</b>\n\n–í –Ω–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å, –ø—Ä–∏–≥–ª–∞—à–∞—è –¥—Ä—É–∑–µ–π! –ö–∞–∂–¥—ã–π –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã–π —á–µ–ª–æ–≤–µ–∫ –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –æ–Ω –º–æ–∂–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏ –Ω–∞—á–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞—à–∏–º–∏ —É—Å–ª—É–≥–∞–º–∏.\n\nüí∏ <b>–ß—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ:</b>\n–í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ <b>{{ config.billing.partner.income_percent }}%</b> –æ—Ç –∫–∞–∂–¥–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞, –∫–æ—Ç–æ—Ä—ã–π —Å–¥–µ–ª–∞–µ—Ç –≤–∞—à —Ä–µ—Ñ–µ—Ä–∞–ª. –≠—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥!\n\nüîó <b>–ö–∞–∫ –ø—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞:</b>\n1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–≤–æ—é —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É.\n2. –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –µ—é —Å –¥—Ä—É–∑—å—è–º–∏, –∫–æ–ª–ª–µ–≥–∞–º–∏ –∏–ª–∏ –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö.\n3. –ö–æ–≥–¥–∞ –≤–∞—à —Ä–µ—Ñ–µ—Ä–∞–ª —Å–¥–µ–ª–∞–µ—Ç –ø–µ—Ä–≤—ã–π –ø–ª–∞—Ç—ë–∂, –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —Å–≤–æ—é –¥–æ–ª—é!\n\nüí° <b>–°–æ–≤–µ—Ç—ã –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –¥–æ—Ö–æ–¥–∞:</b>\n1. –†–∞–∑–º–µ—Å—Ç–∏—Ç–µ —Å—Å—ã–ª–∫—É –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö –∏ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞—Ö.\n2. –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞—Ö –Ω–∞—à–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –∏ –±–æ–Ω—É—Å–∞—Ö –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.\n\n–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã, –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –≤ –Ω–∞—à—É —Å–ª—É–∂–±—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏.\n\nüîó –í–∞—à–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞:\n<code>{{ config.tg_bot.url }}?start={{ user.id }}</code>",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üéØ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π",
                        "switch_inline_query": "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ {{ config.company.name }} –∏ –ø–æ–ª—É—á–∞–π –±–æ–Ω—É—Å—ã! üõ° {{ config.tg_bot.url }}?start={{ user.id }}"
                    }
                ],
                [
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}

<% CASE ['/help'] %>
{{ IF cmd == '/help' }}
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{{ END }}
{
    "sendMessage": {
        "text": "üì° <b>–ü–æ–º–æ—â—å –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</b>\n\n–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –≤–∞—Å –ø—É–Ω–∫—Ç –∏–∑ —Å–ø–∏—Å–∫–∞ –Ω–∏–∂–µ:",
        "parse_mode": "HTML",
        "reply_markup": {
            "keyboard": [
                [
                    {
                        "text": "üñ• –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ VPN"
                    }
                ],
                [
                    {
                        "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é"
                    }
                ]
            ],
            "one_time_keyboard": false,
            "resize_keyboard": true
        }
    }
}
<% CASE ['‚ùì –ü–æ–º–æ—â—å'] %>
{{ IF cmd == '‚ùì –ü–æ–º–æ—â—å' }}
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{{ END }}
{
    "sendMessage": {
        "text": "üì° <b>–ü–æ–º–æ—â—å –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</b>\n\n–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –≤–∞—Å –ø—É–Ω–∫—Ç –∏–∑ —Å–ø–∏—Å–∫–∞ –Ω–∏–∂–µ:",
        "parse_mode": "HTML",
        "reply_markup": {
            "keyboard": [
                [
                    {
                        "text": "üñ• –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ VPN"
                    }
                ],
                [
                    {
                        "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é"
                    }
                ]
            ],
            "one_time_keyboard": false,
            "resize_keyboard": true
        }
    }
}

<% CASE ['üñ• –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ VPN'] %>
{
    "sendMessage": {
        "text": "üñ• <b>–ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é Hiddify</b>\n\n<b>–î–ª—è Android üì±:</b>\n\n1Ô∏è‚É£ **–°–∫–∞—á–∞–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Hiddify** –∏–∑ [Google Play Store üì≤](https://play.google.com/store/apps/details?id=com.hiddify).\n\n<pre><i>–§–æ—Ç–æ: –ù–∞ —ç–∫—Ä–∞–Ω–µ –±—É–¥–µ—Ç –∫–Ω–æ–ø–∫–∞ ¬´–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å¬ª –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ —Å—Å—ã–ª–∫–µ.</i></pre>\n\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "keyboard": [
                [
                    {
                        "text": "‚ùì –ü–æ–º–æ—â—å"
                    }
                ],
                [
                    {
                        "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é"
                    }
                ]
            ],
            "one_time_keyboard": false,
            "resize_keyboard": true
        }
    }
},
{
    "sendPhoto": {
        "photo": "https://sun9-33.userapi.com/impg/XHSYumOmZ6e2tqx7DQhYbqlTPWvlNdO0RPn0gg/fBjhUwOrmZg.jpg?size=1024x1024&quality=95&sign=1850fd2fe7c925d6bb8c32a34a946208&type=album"
    }
},
{
    "sendMessage": {
        "text": "2Ô∏è‚É£ **–û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Hiddify** –∏ –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é –≤—ã–±–µ—Ä–∏ —Ä–µ–≥–∏–æ–Ω ¬´–†–æ—Å—Å–∏—è¬ª üá∑üá∫.\n\n<pre><i>–§–æ—Ç–æ: –ù–∞ —ç–∫—Ä–∞–Ω–µ –±—É–¥–µ—Ç –≤—ã–±–æ—Ä —Ä–µ–≥–∏–æ–Ω–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.</i></pre>\n\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "keyboard": [
                [
                    {
                        "text": "‚ùì –ü–æ–º–æ—â—å"
                    }
                ],
                [
                    {
                        "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é"
                    }
                ]
            ],
            "one_time_keyboard": false,
            "resize_keyboard": true
        }
    }
},
{
    "sendPhoto": {
        "photo": "https://link_to_image2.com"
    }
},
{
    "sendMessage": {
        "text": "3Ô∏è‚É£ **–ù–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É ¬´–°—Ç–∞—Ä—Ç¬ª üöÄ**, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ VPN.\n\n<pre><i>–§–æ—Ç–æ: –ì–ª–∞–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è VPN.</i></pre>\n\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "keyboard": [
                [
                    {
                        "text": "‚ùì –ü–æ–º–æ—â—å"
                    }
                ],
                [
                    {
                        "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é"
                    }
                ]
            ],
            "one_time_keyboard": false,
            "resize_keyboard": true
        }
    }
},
{
    "sendPhoto": {
        "photo": "https://link_to_image3.com"
    }
},
{
    "sendMessage": {
        "text": "4Ô∏è‚É£ **–î–æ–±–∞–≤—å –ø–æ–¥–ø–∏—Å–∫—É**: –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É ¬´–û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É¬ª üîë.\n\n<pre><i>–§–æ—Ç–æ: –ö–Ω–æ–ø–∫–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.</i></pre>\n\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "keyboard": [
                [
                    {
                        "text": "‚ùì –ü–æ–º–æ—â—å"
                    }
                ],
                [
                    {
                        "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é"
                    }
                ]
            ],
            "one_time_keyboard": false,
            "resize_keyboard": true
        }
    }
},
{
    "sendPhoto": {
        "photo": "https://link_to_image4.com"
    }
},
{
    "sendMessage": {
        "text": "5Ô∏è‚É£ **–ü–æ–¥–∫–ª—é—á–∏—Å—å –∫ VPN**: –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏, –Ω–∞ —ç–∫—Ä–∞–Ω–µ –ø–æ—è–≤–∏—Ç—Å—è –±–æ–ª—å—à–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ VPN üîå.\n\n<pre><i>–§–æ—Ç–æ: –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è VPN.</i></pre>\n\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "keyboard": [
                [
                    {
                        "text": "‚ùì –ü–æ–º–æ—â—å"
                    }
                ],
                [
                    {
                        "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é"
                    }
                ]
            ],
            "one_time_keyboard": false,
            "resize_keyboard": true
        }
    }
},
{
    "sendPhoto": {
        "photo": "https://link_to_image5.com"
    }
},
{
    "sendMessage": {
        "text": "6Ô∏è‚É£ **–ü–æ–ª—å–∑—É–π—Å—è –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º üåê**: —Ç–µ–ø–µ—Ä—å —Ç—ã –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ VPN!\n\n<b>–î–ª—è iOS üçè:</b>\n\n1Ô∏è‚É£ **–°–∫–∞—á–∞–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Hiddify** –∏–∑ [App Store üõí](https://apps.apple.com/app/id/app-id).\n\n<pre><i>–§–æ—Ç–æ: –ù–∞ —ç–∫—Ä–∞–Ω–µ –±—É–¥–µ—Ç –∫–Ω–æ–ø–∫–∞ ¬´–ü–æ–ª—É—á–∏—Ç—å¬ª –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ —Å—Å—ã–ª–∫–µ.</i></pre>\n\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "keyboard": [
                [
                    {
                        "text": "‚ùì –ü–æ–º–æ—â—å"
                    }
                ],
                [
                    {
                        "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é"
                    }
                ]
            ],
            "one_time_keyboard": false,
            "resize_keyboard": true
        }
    }
},
{
    "sendPhoto": {
        "photo": "https://link_to_image6.com"
    }
},
{
    "sendMessage": {
        "text": "2Ô∏è‚É£ **–û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Hiddify** –∏ –≤—ã–±–µ—Ä–∏ —Ä–µ–≥–∏–æ–Ω ¬´–†–æ—Å—Å–∏—è¬ª üá∑üá∫ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.\n\n<pre><i>–§–æ—Ç–æ: –í—ã–±–æ—Ä —Ä–µ–≥–∏–æ–Ω–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ Hiddify –¥–ª—è iOS.</i></pre>\n\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "keyboard": [
                [
                    {
                        "text": "‚ùì –ü–æ–º–æ—â—å"
                    }
                ],
                [
                    {
                        "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é"
                    }
                ]
            ],
            "one_time_keyboard": false,
            "resize_keyboard": true
        }
    }
},
{
    "sendPhoto": {
        "photo": "https://link_to_image7.com"
    }
},
{
    "sendMessage": {
        "text": "3Ô∏è‚É£ **–ù–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É ¬´–°—Ç–∞—Ä—Ç¬ª üöÄ**, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ VPN.\n\n<pre><i>–§–æ—Ç–æ: –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.</i></pre>\n\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "keyboard": [
                [
                    {
                        "text": "‚ùì –ü–æ–º–æ—â—å"
                    }
                ],
                [
                    {
                        "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é"
                    }
                ]
            ],
            "one_time_keyboard": false,
            "resize_keyboard": true
        }
    }
},
{
    "sendPhoto": {
        "photo": "https://link_to_image8.com"
    }
},
{
    "sendMessage": {
        "text": "4Ô∏è‚É£ **–î–æ–±–∞–≤—å –ø–æ–¥–ø–∏—Å–∫—É**: –Ω–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É ¬´–û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É¬ª üîë, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É.\n\n<pre><i>–§–æ—Ç–æ: –ö–Ω–æ–ø–∫–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ iOS.</i></pre>\n\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "keyboard": [
                [
                    {
                        "text": "‚ùì –ü–æ–º–æ—â—å"
                    }
                ],
                [
                    {
                        "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é"
                    }
                ]
            ],
            "one_time_keyboard": false,
            "resize_keyboard": true
        }
    }
},
{
    "sendPhoto": {
        "photo": "https://link_to_image9.com"
    }
},
{
    "sendMessage": {
        "text": "5Ô∏è‚É£ **–ü–æ–¥–∫–ª—é—á–∏—Å—å –∫ VPN**: –∫–æ–≥–¥–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞, –Ω–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è üîå.\n\n<pre><i>–§–æ—Ç–æ: –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ VPN –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –¥–ª—è iOS.</i></pre>\n\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "keyboard": [
                [
                    {
                        "text": "‚ùì –ü–æ–º–æ—â—å"
                    }
                ],
                [
                    {
                        "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é"
                    }
                ]
            ],
            "one_time_keyboard": false,
            "resize_keyboard": true
        }
    }
},
{
    "sendPhoto": {
        "photo": "https://link_to_image10.com"
    }
},
{
    "sendMessage": {
        "text": "6Ô∏è‚É£ **–ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –±–µ–∑–æ–ø–∞—Å–Ω—ã–º —Å–µ—Ä—Ñ–∏–Ω–≥–æ–º üåç**: —Ç–µ–ø–µ—Ä—å —Ç—ã –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ VPN!\n\n<b>‚ùó –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:</b>\n\nüîÑ **–ü–æ–ø—Ä–æ–±—É–π –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç, –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è.\n\n<i>–§–æ—Ç–æ: –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</i>\n\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "keyboard": [
                [
                    {
                        "text": "‚ùì –ü–æ–º–æ—â—å"
                    }
                ],
                [
                    {
                        "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é"
                    }
                ]
            ],
            "one_time_keyboard": false,
            "resize_keyboard": true
        }
    }
},
{
    "sendPhoto": {
        "photo": "https://link_to_image11.com"
    }
}



<% CASE '/show_mz_keys' %>
{{ location = storage.read('name', 'vpn_mrzb_' _ args.0).location }}
{{ item = us.id(args.0) }}
{{ subscription_url = storage.read('name', 'vpn_mrzb_' _ args.0 _ location).subscription_url }}
{
    "sendPhoto": {
        "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
        "protect_content": false,
        "parse_mode": "HTML",
        "caption": "üåê <b>–í–∞—à–∏ VPN –∫–ª—é—á–∏ –∏ –ø–æ–¥–ø–∏—Å–∫–∞:</b>\n\nüîó <b>–°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É:</b>\n<code>{{ subscription_url }}</code>\n\nüí° <i>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç URL –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ VPN-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–∞ –≤–∞—à–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.</i>\n\nüîê <b>–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª—é—á –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è:</b>",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üîë –ü–æ–∫–∞–∑–∞—Ç—å 'TCP' ",
                        "callback_data": "/trojan_key {{ args.0 }}"
                    },
                    {
                        "text": "üîë –ü–æ–∫–∞–∑–∞—Ç—å 'UDP' ",
                        "callback_data": "/vless_key {{ args.0 }}"
                    }
                ],
                [
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —É—Å–ª—É–≥–∞–º",
                        "callback_data": "/service {{ args.0 }}"
                    }
                ]
            ]
        }
    }
}

<% CASE '/vless_key' %>
{{ vless_tcp = storage.read('name', 'vpn_mrzb_' _ args.0).links.grep('^vless:').first }}
{
    "printQrCode": {
        "data": "{{ vless_tcp }}",
        "parameters": {
            "parse_mode": "HTML",
            "caption": "‚úÖ <b>–í–∞—à VLESS TCP –∫–ª—é—á —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω!</b>\n\nüì• <i>QR-–∫–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ VPN-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.</i>"
        }
    }
},
{
    "sendMessage": {
        "text": "üîë <b>–í–∞—à VLESS TCP –∫–ª—é—á</b>\n\nüåê <b>–ü—Ä–æ—Ç–æ–∫–æ–ª:</b> VLESS TCP\n\nüóùÔ∏è <b>–ö–ª—é—á:</b> <code>{{ vless_tcp }}</code>\n\nüì≤ <i>–°–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR-–∫–æ–¥ –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ VPN –Ω–∞ –≤–∞—à–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.</i>\n\nüí° <b>–°–æ–≤–µ—Ç:</b> –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á –≤ –Ω–∞–¥–µ–∂–Ω–æ–º –º–µ—Å—Ç–µ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üîÑ –ò–∑–º–µ–Ω–∏—Ç—å —Ç–∞—Ä–∏—Ñ",
                        "callback_data": "/selectservice {{ args.0 }}"
                    }
                ],
                [
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –∫–ª—é—á–∞–º",
                        "callback_data": "/show_mz_keys {{ args.0 }}"
                    }
                ]
            ]
        }
    }
}

<% CASE '/trojan_key' %>
{{ trojan = storage.read('name', 'vpn_mrzb_' _ args.0).links.grep('^trojan:').first }}
{
    "printQrCode": {
        "data": "{{ trojan }}",
        "parameters": {
            "parse_mode": "HTML",
            "caption": "‚úÖ <b>–í–∞—à Trojan TCP –∫–ª—é—á —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω!</b>\n\nüîí <i>QR-–∫–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.</i>\n\nüí° <b>–ù–µ –∑–∞–±—É–¥—å—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–ª—é—á –≤ –Ω–∞–¥–µ–∂–Ω–æ–º –º–µ—Å—Ç–µ.</b>",
            "size": 600
        }
    }
},
{
    "sendMessage": {
        "text": "üîë <b>–í–∞—à Trojan TCP –∫–ª—é—á</b>\n\n<b>–ü—Ä–æ—Ç–æ–∫–æ–ª:</b> Trojan TCP\n\nüóùÔ∏è <b>–ö–ª—é—á:</b> <code>{{ trojan }}</code>\n\nüì≤ <i>–°–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR-–∫–æ–¥ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ VPN –Ω–∞ –≤–∞—à–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.</i>\n\nüí° <b>–°–æ–≤–µ—Ç:</b> –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á –≤ –Ω–∞–¥–µ–∂–Ω–æ–º –º–µ—Å—Ç–µ, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –¥–æ—Å—Ç—É–ø –∫ VPN-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—é.\n\nüîí <b>–ß—Ç–æ —Ç–∞–∫–æ–µ Trojan?</b>\nTrojan ‚Äî —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∏ –±—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª, –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –¥–ª—è –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏ –∑–∞—â–∏—Ç—ã –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏. –û—Å–æ–±–µ–Ω–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –≤ —Å—Ç—Ä–∞–Ω–∞—Ö —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Ä–µ—Å—É—Ä—Å–∞–º.",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –∫–ª—é—á–∞–º",
                        "callback_data": "/show_mz_keys {{ args.0 }}"
                    }
                ]
            ]
        }
    }
}


<% CASE '/primer' %>
{
    "deleteMessage": { "message_id": "{{ message.message_id }}" }
},
{
    "sendMessage": {
        "text": "–ü—Ä–∏–≤–µ—Ç! –ú–µ–Ω—è –∑–æ–≤—É—Ç <b>{{ config.company.name }}</b>. –Ø —Å–¥–µ–ª–∞—é —Ç–≤–æ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –±–æ–ª–µ–µ –¥–æ—Å—Ç—É–ø–Ω—ã–º –∏ –æ—Ç–∫—Ä—ã—Ç—ã–º.\n\n- üîí –ê–±—Å–æ–ª—é—Ç–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –ª—é–±—ã–º —Å–æ—Ü–∏–∞–ª—å–Ω—ã–º —Å–µ—Ç—è–º\n- üåê –û–±—Ö–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π\n- üîì –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º\n- üîë –î–≤–æ–π–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö\n- üí≥ –û–ø–ª–∞—Ç–∞ —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ –∫–∞—Ä—Ç–∞–º–∏\n\n–ü—Ä–∏–Ω—è—Ç—å —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ:",
        "parse_mode": "HTML",
        "photo": "{{ config.logo.url }}",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "–°–æ–≥–ª–∞—à–µ–Ω–∏–µ",
                        "web_app": {
                            "url": "https://wwvpn.bine.life/privacy"
                        }
                    }
                ],
                [
                    {
                        "text": "‚úÖ –î–∞",
                        "callback_data": "/register {{ args.0 }}"
                    },
                    {
                        "text": "‚ùå –ù–µ—Ç",
                        "callback_data": "/disagree"
                    }
                ]
            ]
        }
    }
},
{
    "callbackQuery": {
        "data": "/register {{ args.0 }}",
        "sendMessage": {
            "text": "‚úÖ <b>–°–ø–∞—Å–∏–±–æ –∑–∞ —Å–æ–≥–ª–∞—Å–∏–µ!</b>\n–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞—á–∞—Ç–∞...",
            "parse_mode": "HTML",
            "reply_markup": {
                "inline_keyboard": [
                    [
                        {
                            "text": "üìã –ü–µ—Ä–µ–π—Ç–∏ –≤ –º–µ–Ω—é",
                            "callback_data": "/menu"
                        }
                    ]
                ]
            }
        }
    }
},
{
    "callbackQuery": {
        "data": "/disagree",
        "sendMessage": {
            "text": "üö´ <b>–ë–µ–∑ –ø—Ä–∏–Ω—è—Ç–∏—è —É—Å–ª–æ–≤–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞ –º—ã –Ω–µ –º–æ–∂–µ–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É.</b>",
            "parse_mode": "HTML",
            "photo": "{{ config.logo.url }}",
            "reply_markup": {
                "inline_keyboard": [
                    [
                        {
                            "text": "üîô –ù–∞–∑–∞–¥",
                            "callback_data": "USER_NOT_FOUND"
                        }
                    ]
                ]
            }
        }
    }
}

<% CASE '/disagree' %>
{
    "deleteMessage": { "message_id": "{{ message.message_id }}" }
},
{
    "sendMessage": {
        "text": "üö´ <b>–ë–µ–∑ –ø—Ä–∏–Ω—è—Ç–∏—è —É—Å–ª–æ–≤–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞ –º—ã –Ω–µ –º–æ–∂–µ–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É.</b>",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "–ù–∞–∑–∞–¥",
                        "callback_data": "/USER_NOT_FOUND"
                    }
                ]
            ]
        }
    }
}

<% CASE '/blocked_services' %>
{{ blocked_services = ref(user.services.list_for_api('admin', 1, 'limit', limit, 'offset', offset, 'filter', { 'status': 'BLOCK' })) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "üî¥ <b>–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏</b>\n\n{{ IF blocked_services }}{{ FOR service IN blocked_services }}üõ†Ô∏è <b>–°–µ—Ä–≤–∏—Å:</b> {{ service.name }}\nüë§ <b>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</b> {{ service.user }}\nüìÜ <b>–î–∞—Ç–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:</b> {{ service.block_date }}\n\n{{ END }}{{ ELSE }}‚ö†Ô∏è –ù–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—Å–ª—É–≥.{{ END }}",
        "reply_markup": {
            "inline_keyboard": [
                [
                    { "text": "üîô –ù–∞–∑–∞–¥", "callback_data": "/adminmenu" }
                ]
            ]
        }
    }
}

<% CASE '/expired_services' %>
{{ expired_services = ref(user.services.list_for_api('admin', 1, 'limit', limit, 'offset', offset, 'filter', { 'status': 'NOT PAID' })) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "üü° <b>–ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏</b>\n\n{{ IF expired_services }}{{ FOR service IN expired_services }}üõ†Ô∏è <b>–°–µ—Ä–≤–∏—Å:</b> {{ service.name }}\nüë§ <b>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</b> {{ service.user }}\nüìÜ <b>–î–∞—Ç–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è:</b> {{ service.expiry_date }}\n\n{{ END }}{{ ELSE }}‚ö†Ô∏è –ù–µ—Ç –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö —É—Å–ª—É–≥.{{ END }}",
        "reply_markup": {
            "inline_keyboard": [
                [
                    { "text": "üîô –ù–∞–∑–∞–¥", "callback_data": "/adminmenu" }
                ]
            ]
        }
    }
}

<% CASE '/adminmenu' %>
{{ IF message.chat.id == config.telegram_admin.id OR message.chat.id == config.telegram_admin2.id OR message.chat.id == config.telegram_admin3.id }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "üì° <b>–ê–¥–º–∏–Ω–∫–∞</b>\n\n–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º:",
        "reply_markup": {
            "inline_keyboard": [
                [
                    { "text": "üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏", "callback_data": "/admusers" },
                    { "text": "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", "callback_data": "/admstats" }
                ],
                [
                    { "text": "üéÅ –ü—Ä–æ–º–æ–∫–æ–¥—ã", "callback_data": "/adminpromocodes" },
                    { "text": "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏", "callback_data": "/adminsettings" }
                ],
                [
                    { "text": "üìÖ –û—Ç—á–µ—Ç –∑–∞ –º–µ—Å—è—Ü", "callback_data": "/monthlyreport" },
                    { "text": "üìù –õ–æ–≥–∏", "callback_data": "/adminlogs" }
                ],
                [
                    { "text": "üì® –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é", "callback_data": "/admusermsg" },
                    { "text": "üîí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º", "callback_data": "/adminaccess" }
                ],
                [
                    { "text": "üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ", "callback_data": "/admmaintenance" },
                    { "text": "üíª –°–µ—Ä–≤–µ—Ä—ã", "callback_data": "/admservers" }
                ],
                [
                    { "text": "üè† –î–æ–º–æ–π", "callback_data": "/menu" }
                ]
            ]
        }
    }
}
{{ END }}

<% CASE '/adminpromocodes' %>
{{ IF message.chat.id == config.telegram_admin.id OR message.chat.id == config.telegram_admin2.id OR message.chat.id == config.telegram_admin3.id }}
{{ promocodes = ref(service.create_for_api('get_promocodes')) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "üéÅ <b>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞–º–∏</b>\n\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:",
        "reply_markup": {
            "inline_keyboard": [
                [
                    { "text": "üìÑ –°–ø–∏—Å–æ–∫ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤", "callback_data": "/listpromocodes" },
                    { "text": "‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥", "callback_data": "/addpromocode" }
                ],
                [
                    { "text": "‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥", "callback_data": "/editpromocode" },
                    { "text": "üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥", "callback_data": "/deletepromocode" }
                ],
                [
                    { "text": "üîô –ù–∞–∑–∞–¥", "callback_data": "/adminmenu" }
                ]
            ]
        }
    }
}
{{ ELSE }}
{
    "sendMessage": {
        "text": "‚õî –£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–µ."
    }
}
{{ END }}

<% CASE '/listpromocodes' %>
{{ IF message.chat.id == config.telegram_admin.id OR message.chat.id == config.telegram_admin2.id OR message.chat.id == config.telegram_admin3.id }}
{{ promocodes = ref(service.create_for_api('get_promocodes')) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "üìÑ <b>–°–ø–∏—Å–æ–∫ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤</b>\n\n{{ IF promocodes }}{{ FOR promo IN promocodes }}üéüÔ∏è <b>–ö–æ–¥:</b> {{ promo.code }}\nüìÜ <b>–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ:</b> {{ promo.expiry_date }}\n‚úÖ <b>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π:</b> {{ promo.uses }} / {{ promo.max_uses }}\nüõ†Ô∏è <b>–°—Ç–∞—Ç—É—Å:</b> {{ promo.is_active == 1 and '–ê–∫—Ç–∏–≤–µ–Ω' or '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω' }}\n\n{{ END }}{{ ELSE }}‚ö†Ô∏è –ü—Ä–æ–º–æ–∫–æ–¥—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.{{ END }}",
        "reply_markup": {
            "inline_keyboard": [
                [
                    { "text": "‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥", "callback_data": "/addpromocode" },
                    { "text": "‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥", "callback_data": "/editpromocode" }
                ],
                [
                    { "text": "üîô –ù–∞–∑–∞–¥", "callback_data": "/adminpromocodes" }
                ]
            ]
        }
    }
}
{{ ELSE }}
{
    "sendMessage": {
        "text": "‚õî –£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–µ."
    }
}
{{ END }}

<% CASE '/addpromocode' %>
{{ IF message.chat.id == config.telegram_admin.id OR message.chat.id == config.telegram_admin2.id OR message.chat.id == config.telegram_admin3.id }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "üìù <b>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–º–æ–∫–æ–¥</b>\n\n–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–º–æ–∫–æ–¥–∞:",
        "reply_markup": {
            "force_reply": true
        }
    }
}
{{ ELSE }}
{
    "sendMessage": {
        "text": "‚õî –£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–µ."
    }
}
{{ END }}

<% CASE '/admservers' %>
{{ IF message.chat.id == config.telegram_admin.id OR message.chat.id == config.telegram_admin2.id OR message.chat.id == config.telegram_admin3.id }}
{{ servers = ref(service.create_for_api('servers')) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "üñ•Ô∏è <b>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤</b>",
        "reply_markup": {
            "inline_keyboard": [
                [
                    { "text": "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏", "callback_data": "/adminsettings" },
                    { "text": "üîô –ù–∞–∑–∞–¥", "callback_data": "/adminmenu" }
                ]
            ]
        }
    }
}
{{ END }}

<% CASE '/admstats' %>
{{ IF message.chat.id == config.telegram_admin.id OR message.chat.id == config.telegram_admin2.id OR message.chat.id == config.telegram_admin3.id }}
{{ stats = ref(service.create_for_api('stats')) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "üìä <b>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞</b>\n\nüë• <b>–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</b> {{ stats.total_users }}\nüü¢ <b>–ê–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞ —Å—É—Ç–∫–∏:</b> {{ stats.active_users }}\nüìÖ <b>–ù–æ–≤—ã—Ö –∑–∞ –º–µ—Å—è—Ü:</b> {{ stats.new_users }}\n\nüõ†Ô∏è <b>–ê–∫—Ç–∏–≤–Ω—ã—Ö —É—Å–ª—É–≥:</b> {{ stats.active_services }}\n‚ùå <b>–û—à–∏–±–æ–∫ –∑–∞ –Ω–µ–¥–µ–ª—é:</b> {{ stats.error_count }}",
        "reply_markup": {
            "inline_keyboard": [
                [
                    { "text": "üìÖ –û—Ç—á–µ—Ç –∑–∞ –º–µ—Å—è—Ü", "callback_data": "/monthlyreport" },
                    { "text": "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏", "callback_data": "/adminsettings" }
                ],
                [
                    { "text": "üîô –ù–∞–∑–∞–¥", "callback_data": "/adminmenu" }
                ]
            ]
        }
    }
}
{{ ELSE }}
{
    "sendMessage": {
        "text": "‚õî –£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–µ."
    }
}
{{ END }}

<% CASE '/monthlyreport' %>
{{ IF message.chat.id == config.telegram_admin.id OR message.chat.id == config.telegram_admin2.id OR message.chat.id == config.telegram_admin3.id }}
{{ report = ref(service.create_for_api('monthly_report')) }}
{{ servers = ref(service.create_for_api('servers')) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "üìÖ <b>–û—Ç—á–µ—Ç –∑–∞ –º–µ—Å—è—Ü</b>\n\nüë• <b>–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</b> {{ report.total_users }}\nüü¢ <b>–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</b> {{ report.active_users }}\nüìà <b>–ù–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</b> {{ report.new_users }}\n\nüñ•Ô∏è <b>–°–µ—Ä–≤–µ—Ä—ã:</b>\n{{ FOR server IN servers }}üü¢ <b>–°–µ—Ä–≤–µ—Ä:</b> {{ server.name }}\nüìÖ <b>–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –æ–ø–ª–∞—Ç—ã:</b> {{ server.payment_expiry_date | default('–ù–µ —É–∫–∞–∑–∞–Ω–∞') }}\n‚ùå <b>–û—à–∏–±–∫–∏:</b> {{ server.error_count }}\n{{ IF server.payment_expiry_date <= current_date }}‚ö†Ô∏è <b>–û–ø–ª–∞—Ç–∞ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å!</b>\n{{ END }}{{ END }}",
        "reply_markup": {
            "inline_keyboard": [
                [
                    { "text": "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏", "callback_data": "/adminsettings" },
                    { "text": "üîô –ù–∞–∑–∞–¥", "callback_data": "/adminmenu" }
                ]
            ]
        }
    }
}
{{ ELSE }}
{
    "sendMessage": {
        "text": "‚õî –£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–µ."
    }
}
{{ END }}

<% CASE ['/admusers', '/qadmusers'] %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{
  limit = 10
  data = []
}}
{{
  offset = args.0 || 0
  itemsa = ref( user.list_for_api('admin',1,'limit',limit, 'offset',offset,'sort_direction'asc,'filter',{"gid" = 0}) )
}}
{{ FOR itema IN itemsa }}
{{ status = (itema.block == 0 ? "üü¢" : "üî¥") }}
{{ data.push(
    [{
      "text" = status _ itema.user_id _ '.' _ itema.full_name _ '-' _ itema.login
      "callback_data" = '/admuser ' _ itema.user_id
    }]
  )
}}
{{ END }}
{{ IF itemsa.size == limit }}
{{ data.push(
    [{
      "text" = '–î–∞–ª–µ–µ ‚ñ∂Ô∏è',
      "callback_data" = '/admusers ' _ (limit + offset)
    }]
  )
}}
{{ END }}
{{ IF offset > 0 }}
{{ data.push(
    [{
      "text" = '‚óÄÔ∏è –ù–∞–∑–∞–¥',
      "callback_data" = '/admusers ' _ (offset - limit)
    }]
  )
}}
{{ END }}
{{ data.push(
 [{
      "text" = '–í–µ—Å—å —Å–ø–∏—Å–æ–∫',
      "callback_data" = '/admusersall'
    }], [{
      "text" = '–ê–¥–º–∏–Ω–∫–∞'
      "callback_data" = '/adminmenu'
    },{
      "text" = 'üè† –î–æ–º–æ–π'
      "callback_data" = '/menu'
    }]
  )
}}
{{ IF cmd == '/qadmusers' }}
{
    "sendMessage": {
{{ END }}
{{ IF cmd == '/admusers' }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
{{ END }}
    "text": "–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
    "reply_markup" : {
      "inline_keyboard": {{ toJson( data ) }}
    }
  }
}
{{ END }}

<% CASE ['/admuser', '/qadmuser'] %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ user_services = ref(user.services.list_for_api('category','%')) }}
{{ FOR itemlk IN ref(user.id(args.0)) }}
{{ IF cmd == '/qadmuser' }}
{
    "sendMessage": {
{{ END }}
{{ IF cmd == '/admuser' }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
{{ END }}
        "text": "{{ itemlk.full_name }}\n{{ itemlk.login }}\n–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: {{ itemlk.created }}\n–£—Å–ª—É–≥: {{ user_services.size }}\n–ë–∞–ª–∞–Ω—Å: {{ itemlk.balance }}‚ÇΩ\n–°–∫–∏–¥–∫–∞: {{ itemlk.discount }}%\n–ë–æ–Ω—É—Å—ã: {{ itemlk.get_bonus }}{{ IF user.block == 1 }}\nüî¥ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω{{ END }}",
        "reply_markup" : {
            "inline_keyboard": [
                         {{ IF user.block == 0 }}
                         {{ IF user_services.size > 0 }}
                       [
                    {
                        "text": "–£—Å–ª—É–≥–∏",
                        "callback_data": "/admservice {{ itemlk.id }}"
                    }
                ],{{ ELSE }} 
                 [
                    {
                        "text": "–î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É",
                        "callback_data": "/admpricelist {{ itemlk.id }}"
                    }
                ],
                  {{ END }} [
                    {
                        "text": "–ü–ª–∞—Ç–µ–∂–∏",
                        "callback_data": "/admpay {{ itemlk.id }}"
                    }
                ],
				[
                    {
                        "text": "–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π",
                        "callback_data": "/listPays {{ itemlk.id }}"
                    }
                ],
				[
                    {
                        "text": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–ø–∏—Å–∞–Ω–∏–∏",
                        "callback_data": "/withdraws {{ itemlk.id }}"
                    }
                ],
                 [
                    {
                        "text": "–ë–æ–Ω—É—Å—ã",
                        "callback_data": "/admpayb {{ itemlk.id }}"
                    }
                ], [
                    {
                        "text": "–ù–∞–ø–∏—Å–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é",
                        "callback_data": "/admusermsg {{ user.settings.telegram.chat_id }}"
                    }
                ],{{ END }}
                  {{ IF user.block == 0 }}
                     [
                    {
                        "text": "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å",
                        "callback_data": "/admuserblock {{ itemlk.id }}"
                    }
                ], {{ ELSE }}[
                    {
                        "text": "–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å",
                        "callback_data": "/admuseractiv {{ itemlk.id }}"
                    }
                ],
               {{ END }}
                 [
                   {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    }, {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]{{ END }}    
        }
    }
}
{{ END }}
<% CASE '/admusermsg' %>
{
"sendMessage": {
        "text": "#{{ args.0 }}#\n–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        "reply_markup": {
            "force_reply": true
        }
    }
}

<% CASE '/admpricelist' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "‚ò∑ –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É –¥–ª—è\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {{ user.full_name }}",
        "reply_markup" : {
            "inline_keyboard": [
                {{ FOR itemprl IN ref(service.api_price_list).nsort('cost') }}
                [
                    {
                        "text": "{{ itemprl.name }}.",
                        "callback_data": "/admserviceorder {{ user.id }} 0 {{ itemprl.service_id }}"
                    }
                ],
                {{ END }}
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                   {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    }, {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }}
<% CASE '/admserviceorder' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }} }
},
{
    "billcpServiceOrder": {
        "service_id": "{{ args.2 }}",
        "callback_data": "/admuser {{ user.id }}",
        "cb_not_enough_money": "/admuser {{ user.id }}",
        "error": "–û–®–ò–ë–ö–ê"
    }
}{{ END }}
<% CASE '/admuserblock' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ usisbl = user.services.list_for_api('usi', {}) }}
{{ usblall =  us.id(usisbl.user_service_id(usisbl.user_service_id)).block }}
{{ userblocks = user.set('block',1) }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {{ user.full_name }}\n–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ωüî¥\n–£—Å–ª—É–≥–∞: {{ usisbl.name }}\n–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞üî¥",
        "reply_markup" : {
            "inline_keyboard": [
                       [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                     {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },{
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ END }}
<% CASE '/admuseractiv' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ usisact = user.services.list_for_api('usi', {}) }}
{{ activ =  us.id(usisact.user_service_id(usisact.user_service_id)).activate }}
{{ useractivs = user.set('block',0) }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {{ user.full_name }}\n–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ωüü¢\n–£—Å–ª—É–≥–∞: {{ usisact.name }}\n–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞üü¢",
        "reply_markup" : {
            "inline_keyboard": [
                       [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                     {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },{
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ END }}
<% CASE '/admusiblock' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ usisb = user.services.list_for_api('usi', {}) }}
{{ blocks =  us.id(usisb.user_service_id(usisb.user_service_id)).block }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {{ user.full_name }}\n–£—Å–ª—É–≥–∞: {{ usisb.name }}\n–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ",
        "reply_markup" : {
            "inline_keyboard": [
                       [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                     {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },{
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ END }}
<% CASE '/admusiactive' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ usisa = user.services.list_for_api('usi', {}) }}
{{ activ =  us.id(usisa.user_service_id(usisa.user_service_id)).activate }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {{ user.full_name }}\n–£—Å–ª—É–≥–∞: {{ usisa.name }}\n–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ",
        "reply_markup" : {
            "inline_keyboard": [
                       [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                     {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/users"
                    },{
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/admin"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ END }}
<% CASE '/admsmena' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ ussm = user.services.list_for_api('usi', {}) }}
{{ USE date }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–°–º–µ–Ω–∞ —Ç–∞—Ä–∏—Ñ–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–æ–¥–ª–µ–Ω–∏–∏\n\n<b>–¢–µ–∫—É—â–∏–π —Ç–∞—Ä–∏—Ñ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {{ user.full_name }}\n</b>{{ ussm.name }}\n<b>–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ</b>: {{ date.format(us.expire, '%H:%M %d.%m.%Y') }}  (–ú–°–ö)\n\n<b>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –ø–µ—Ä–∏–æ–¥</b>",
        "reply_markup" : {
            "inline_keyboard": [               
                {{ FOR itemsm IN ref(service.api_price_list).nsort('cost') }}                 
                [
                    {
                        "text": "{{ itemsm.name }}.",
                        "callback_data": "/admchoise {{ ussm.user_id }} 0 {{ itemsm.service_id }}"
                    }
                ],
                {{ END }} 
                  [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                   {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    }, {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }} 
<% CASE '/admchoise' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ itemadmch = user.services.list_for_api('usi', {}) }}
{{ ntch = us.id(itemadmch.user_service_id).set('next', args.2) }}
{{ USE date }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–¢–∞—Ä–∏—Ñ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {{ user.full_name }} –∏–∑–º–µ–Ω—ë–Ω. \n\n–°–º–µ–Ω–∞ —Ç–∞—Ä–∏—Ñ–∞ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç {{ date.format(us.expire, '%H:%M %d.%m.%Y') }}",
        "reply_markup" : {
            "inline_keyboard": [ 
                  [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ],[
                   {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    }, {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }}
<% CASE '/admchoisenull' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ itemadmchn = user.services.list_for_api('usi', {}) }}
{{ ntchn = us.id(itemadmchn.user_service_id).set('next') }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–°–º–µ–Ω–∞ —Ç–∞—Ä–∏—Ñ–∞: {{ itemadmchn.name }}\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {{ user.full_name }}\n–û—Ç–º–µ–Ω–µ–Ω–∞.",
        "reply_markup" : {
            "inline_keyboard": [ 
                  [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                   {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    }, {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ END }}
<% CASE '/admdelete' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ usisdel = user.services.list_for_api( 'usi', {} ) }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–£–¥–∞–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∏: {{ usisdel.name }}\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {{ user.full_name }}\n\nü§î <b>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ. –ö–ª—é—á –Ω–µ–ª—å–∑—è –±—É–¥–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å!</b>",
        "reply_markup" : {
            "inline_keyboard": [
                [
                    {
                        "text": "üóë –î–ê, –£–î–ê–õ–ò–¢–¨! üóë",
                        "callback_data": "/admdelete_confirmed {{ user.id }}"
                    }
                ],
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                   {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    }, {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }}
<% CASE '/admdelete_confirmed' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ usisdels = user.services.list_for_api( 'usi', {} ) }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }} }
},
{
    "billcpServiceDelete": {
        "usi": "{{ usisdels.user_service_id }}",
        "callback_data": "/admuser {{ user.id }}",
        "error": "–û–®–ò–ë–ö–ê"
    }
}
 {{ END }}

<% CASE '/admpay' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{
    userData = user.id(args.0);
    priceList = ref(service.api_price_list('category', '%')).nsort('cost');
}}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "<blockquote>üë§ <b>{{ userData.full_name }} (ID: {{ userData.user_id }})</b>\nüí∞ <b>–ë–∞–ª–∞–Ω—Å:</b> {{ userData.balance }}‚ÇΩ\n\nüíµ <b>–ó–∞—á–∏—Å–ª–∏—Ç—å:</b></blockquote>",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "10‚ÇΩ",
                        "callback_data": "/admpayment {{ userData.user_id }} 10"
                    },
                    {
                        "text": "50‚ÇΩ",
                        "callback_data": "/admpayment {{ userData.user_id }} 50"
                    },
                    {
                        "text": "100‚ÇΩ",
                        "callback_data": "/admpayment {{ userData.user_id }} 100"
                    },
					{
                        "text": "150‚ÇΩ",
                        "callback_data": "/admpayment {{ userData.user_id }} 150"
                    },
					{
                        "text": "300‚ÇΩ",
                        "callback_data": "/admpayment {{ userData.user_id }} 300"
                    }
                ],
                {{ FOR item IN priceList }}
                [
                    {
                        "text": "{{ item.name }} - {{ item.cost }}‚ÇΩ",
                        "callback_data": "/admpayment {{ userData.user_id _ ' ' }} {{ item.cost }}"
                    }
                ],
                {{ END }}
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ userData.user_id }}"
                    }
                ],
                [
                    {
                        "text": "üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },
                    {
                        "text": "‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ END }}

<% CASE '/admpayshistory' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{
    userPay = ref(pay.list_for_api('admin', 10, 'filter', {"id" = args.0})).last;
    payData = userPay.comment.object;
    payMethod = payData.payment_method;
    payCard = payMethod.card;
    userData = user.id(userPay.user_id);
}}
{{ TEXT = BLOCK }}
üí∏ <b>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–ª–∞—Ç–µ–∂–µ ID {{ userPay.id }}</b> –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {{ userData.full_name }} ({{ userData.user_id }})

üìÖ <b>–î–∞—Ç–∞ –ø–ª–∞—Ç–µ–∂–∞:</b> {{ userPay.date }}
üè¶ <b>–ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:</b> <code>{{ userPay.pay_system_id }}</code>
üíµ <b>–°—É–º–º–∞:</b> {{ userPay.money }} —Ä—É–±.

{{ IF userPay.comment.comment }}
üìù <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –ø–ª–∞—Ç–µ–∂—É</b>
<blockquote>{{ userPay.comment.comment }}</blockquote>
{{ END }}

{{ IF payData }}
üìä <b>–î–∞–Ω–Ω—ã–µ –æ –ø–ª–∞—Ç–µ–∂–µ</b>
<blockquote>
üîë <b>ID –≤ —Å–∏—Å—Ç–µ–º–µ:</b> {{ payData.id }}
üìä <b>–°—Ç–∞—Ç—É—Å:</b> {{ payData.status }}
{{ IF payCard }}
üí≥ <b>–¢–∏–ø –∫–∞—Ä—Ç—ã:</b> {{ payCard.card_type }}
üî¢ <b>–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã:</b> {{ payCard.first6 }}******{{ payCard.last4 }}
üè¶ <b>–ë–∞–Ω–∫:</b> {{ payCard.issuer_name }}
üåç <b>–°—Ç—Ä–∞–Ω–∞ –±–∞–Ω–∫–∞:</b> {{ payCard.issuer_country }}
üìÖ <b>–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è:</b> {{ payCard.expiry_month }}/{{ payCard.expiry_year }}
{{ END }}
{{ IF payMethod.type == 'sbp' }}
üíº <b>–¢–∏–ø –æ–ø–ª–∞—Ç—ã:</b> –°–ë–ü
üî¢ <b>–ù–æ–º–µ—Ä –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –°–ë–ü:</b> {{ payMethod.sbp_operation_id }}
üè¶ <b>–ë–ò–ö –±–∞–Ω–∫–∞:</b> {{ payMethod.payer_bank_details.bic }}
{{ END }}

{{ IF payMethod.title.match('YooMoney') }}
üíº <b>–ö–æ—à–µ–ª–µ–∫ YooMoney:</b> {{ payMethod.title }}
üîë <b>ID –∫–æ—à–µ–ª—å–∫–∞:</b> {{ payMethod.account_number }}
{{ END }}
</blockquote>
{{ END }}

{{ END }}


{
    "sendMessage": {
        "parse_mode": "HTML",
        "text": "<blockquote>{{ TEXT.replace('\n','\n') }}\n</blockquote>",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ userData.user_id }}"
                    }
                ],
                [
                    {
                        "text": "üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },
                    {
                        "text": "‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ ELSE }}
{
    "sendMessage": {
        "parse_mode": "HTML",
        "text": "‚ùå –û—à–∏–±–∫–∞: –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —ç—Ç–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏."
    }
}
{{ END }}


<% CASE '/withdraws' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{
    data = ref(wd.list_for_api('admin', 10, 'filter', {"withdraw_id" = args.0})).first;
    userData = user.id(data.user_id);
}}
{
    "sendMessage": {
        "parse_mode": "HTML",
        "text": "<blockquote>üí∏ <b>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–ø–∏—Å–∞–Ω–∏–∏ ‚Ññ{{ data.withdraw_id }}</b>\nüë§ <b>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</b> {{ userData.full_name }} (ID: {{ userData.user_id }})\nüõ†Ô∏è <b>–£—Å–ª—É–≥–∞:</b> {{ data.name }} (ID: {{ data.user_service_id }})\nüíµ <b>–°—Ç–æ–∏–º–æ—Å—Ç—å:</b> {{ data.cost }}‚ÇΩ\nüìÖ <b>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</b> {{ data.create_date }}\nüìÖ <b>–î–∞—Ç–∞ —Å–ø–∏—Å–∞–Ω–∏—è:</b> {{ data.withdraw_date }}\nüìÖ <b>–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è:</b> {{ data.end_date }}\nüìÜ <b>–ö–æ–ª-–≤–æ –º–µ—Å—è—Ü–µ–≤:</b> {{ data.months }}</blockquote>",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ userData.user_id }}"
                    }
                ],
                [
                    {
                        "text": "üîç –ü–æ–¥—Ä–æ–±–Ω–µ–µ",
                        "callback_data": "/listWithdraws {{ userData.user_id }}"
                    }
                ],
                [
                    {
                        "text": "üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },
                    {
                        "text": "‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ ELSE }}
{
    "sendMessage": {
        "parse_mode": "HTML",
        "text": "‚ùå –û—à–∏–±–∫–∞: –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —ç—Ç–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏."
    }
}
{{ END }}


<% CASE '/listPays' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{
    limit = 5;
    offset = args.1 || 0;
    userData = user.id(args.0);
    payData = userPay.comment.object;
    payMethod = payData.payment_method;
    payCard = payMethod.card;
    userPays = ref(userData.pays.list_for_api('limit', limit, 'offset', offset ));
}}

{
    "sendMessage": {
        "parse_mode": "HTML",
        "text": "üë®‚Äçüíª <b>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {{ userData.full_name }} (ID: {{ userData.user_id }})</b>\n\nüíº <b>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∏:</b>\n{{ FOR item in userPays }}üîπ <b>ID:</b> {{ item.id }} | üíµ <b>–°—É–º–º–∞:</b> {{ item.money }}‚ÇΩ | üìÖ <b>–î–∞—Ç–∞:</b> {{ item.date }} | üè¶ <b>–ü–ª–∞—Ç—ë–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:</b> {{ pay.pay_system_id }}\n{{ END }}",
        "reply_markup": {
            "inline_keyboard": [
                {{ FOR item in userPays }}
                [
                    {
                        "text": "(ID: {{ item.id }}), {{ item.money }}‚ÇΩ, {{ item.date }}",
                        "callback_data": "/admpayshistory {{ item.id }}"
                    }
                ],
                {{ END }}
                {{ IF offset > 0 }}
                [
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
                        "callback_data": "/listPays {{ userData.user_id }} {{ offset - limit }}"
                    }
                ],
                {{ END }}
                {{ IF userPays.size == limit }}
                [
                    {
                        "text": "–ï—â—ë ‚û°Ô∏è",
                        "callback_data": "/listPays {{ userData.user_id }} {{ limit + offset }}"
                    }
                ],
                {{ END }}
                [
                    {
                        "text": "‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–ª–∞—Ç–µ–∂",
                        "callback_data": "/admpay {{ userData.user_id }}"
                    }
                ],
                [
                    {
                        "text": "‚¨ÖÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ",
                        "callback_data": "/admusr {{ userData.user_id }}"
                    }
                ],
                [
                    {
                        "text": "üë®‚Äçüíª –ú–µ–Ω—é",
                        "callback_data": "/adminmenu"
                    },
                    {
                        "text": "üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ ELSE }}
{
    "sendMessage": {
        "parse_mode": "HTML",
        "text": "‚ùå –û—à–∏–±–∫–∞: –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —ç—Ç–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏."
    }
}
{{ END }}

<% CASE '/admpayment' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{
    userData = user.id(args.0);
    amount = args.1;
    comment = "–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º —á–µ—Ä–µ–∑ Telegram"
}}
{{ IF amount > 0 }}
{{
    pay = userData.payment('money', amount, 'TG_Admin', 'Admin', comment);
    userData = user.id(args.0);
}}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "‚úÖ <b>{{ userData.full_name }}</b>\nüí∞ <b>–ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞:</b> {{ amount }}‚ÇΩ\nüí≥ <b>–ù–æ–≤—ã–π –±–∞–ª–∞–Ω—Å:</b> {{ userData.balance }}‚ÇΩ",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
                        "callback_data": "/admpay {{ userData.user_id }}"
                    }
                ],
                [
                    {
                        "text": "‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ ELSE }}
{
    "sendMessage": {
        "parse_mode": "HTML",
        "text": "‚ùå –û—à–∏–±–∫–∞: –°—É–º–º–∞ –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ 0."
    }
}
{{ END }}

<% CASE '/admpayb' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ FOR itemplb IN ref(user.id(args.0)) }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "<code>{{ itemplb.full_name }}\n–ë–æ–Ω—É—Å–æ–≤: {{ itemplb.get_bonus }}</code>\n\n–ó–∞—á–∏—Å–ª–∏—Ç—å –±–æ–Ω—É—Å–æ–≤:",
        "reply_markup" : {
            "inline_keyboard": [
                       [
                    {
                        "text": "10",
                        "callback_data": "/admpaymentb {{ itemplb.user_id }} 10"
                    }
                ], [
                    {
                        "text": "50",
                        "callback_data": "/admpaymentb {{ itemplb.user_id }} 50"
                    }
                ], [
                    {
                        "text": "100",
                        "callback_data": "/admpaymentb {{ itemplb.user_id }} 100"
                    }
                ],
                          [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ],  [
                    {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },{
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]{{ END }}    
        }
    }
}
{{ END }}  


<% CASE '/admpaymentb' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch( args.0 ) }}
{{ bon = user.add_bonus( args.1 ) }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "üí∞ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {{ user.full_name }} (ID: <code>{{ user.id }})</code> –Ω–∞—á–∏—Å–ª–µ–Ω–æ {{ args.1 }}‚ÇΩ –±–æ–Ω—É—Å–æ–≤.",
        "reply_markup" : {
            "inline_keyboard": [
                       [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ],  [
                    {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },{
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ END }}

<% CASE %>
{{ IF message.reply_to_message.chat.id == tpl.settings.admin.chat_id }}
    {{ text = message.reply_to_message.caption || message.reply_to_message.text }}
    {{ chatid = text.split('#').1 }}
    
    {{ IF chatid }}
        {{ IF message.photo }}
            {
                "sendPhoto": {
                    "chat_id": "{{ chatid }}",
                    "photo": "{{ message.photo.0.file_id }}",
                    "caption": "<blockquote><b>–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏:</b></blockquote>\n\n<blockquote>{{ message.caption }}</blockquote>"
                }
            }
        {{ ELSIF message.text }}
            {
                "sendMessage": {
                    "chat_id": "{{ chatid }}",
                    "text": "<blockquote><b>–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏:</b></blockquote>\n\n<pre>{{ message.text }}</pre>\n\n"
                }
            }
        {{ ELSE }}
            {
                "sendMessage": {
                    "chat_id": "{{ chatid }}",
                    "text": "–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ"
                }
            }
        {{ END }}
    {{ ELSE }}
        {
            "sendMessage": {
                "chat_id": "{{ tpl.settings.admin.chat_id }}",
                "text": "–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –≤—ã –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ"
            }
        }
    {{ END }}
{{ ELSE }}
    {{ IF message.photo }}
        {
            "sendPhoto": {
                "chat_id": "{{ tpl.settings.admin.chat_id }}",
                "photo": "{{ message.photo.0.file_id }}",
                "caption": "<blockquote><b>#{{ user.settings.telegram.chat_id }}#</b></blockquote>\n\n<blockquote>{{ message.caption }}</blockquote>\n\n<i>–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {{ user.full_name }}.</i>"
            }
        }
    {{ ELSIF message.text }}
        {
            "sendMessage": {
                "chat_id": "{{ tpl.settings.admin.chat_id }}",
                "text": "<blockquote><b>#{{ user.settings.telegram.chat_id }}# \n–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {{ user.full_name }}:</b></blockquote>\n\n<pre>{{ message.text }}</pre>"
            }
        }
    {{ ELSE }}
        {
            "sendMessage": {
                "text": "–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ"
            }
        }
    {{ END }}
{{ END }}

<% END %>
