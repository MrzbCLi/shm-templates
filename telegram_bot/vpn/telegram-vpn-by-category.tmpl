{{
  limit = 5
  data = []
}}
<% SWITCH cmd %>
<% CASE 'USER_NOT_FOUND' %>
{
    "shmRegister": {
        "partner_id": "{{ args.0 }}",
        "callback_data": "/start",
        "error": "–û–®–ò–ë–ö–ê: –õ–æ–≥–∏–Ω {{ message.chat.username }} –∏–ª–∏ chat_id {{ message.chat.id }} —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
    }
},
{
    "sendPhoto": {
        "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
        "caption": "üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à —Å–µ—Ä–≤–∏—Å! –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–π VPN –∫–ª—é—á.",
        "parse_mode": "HTML"
    }
}

<% CASE '/register' %>
{
    "deleteMessage": { 
        "message_id": "{{ message.message_id }}" 
    },
    {
    "shmRegister": {
        "partner_id": "{{ args.0 }}",
        "callback_data": "/pricelist",
        "error": "–û–®–ò–ë–ö–ê: –õ–æ–≥–∏–Ω {{ message.chat.username }} –∏–ª–∏ chat_id {{ message.chat.id }} —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É, –µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è."
    }
}

<% CASE ['/start', '/menu', 'üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é'] %>

{
    {{ IF cmd == '/menu' OR cmd == '–ú–µ–Ω—é' }}
    "deleteMessage": { "message_id": "{{ message.message_id }}" },
    {{ END }}

    "sendPhoto": {
        "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
        "protect_content": true,
        "parse_mode": "HTML",
        "caption": "üëã <b>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <u>{{ user.full_name }}</u>!</b>\n\nüåê <b>{{ config.company.name }}</b> ‚Äî <i>–ª—É—á—à–∏–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è!</i>\n\nüí∏ <b>–í—ã–≥–æ–¥–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã:</b>\n- –í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å.\n- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.\n- –ì–ª–æ–±–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ.\n\nüì≤ <b>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:</b>\n<a href=\"{{ config.apk.android }}\">üì≤ Android</a> | <a href=\"{{ config.apk.ios }}\">üì≤ iOS</a>\n\nüõ°Ô∏è <b>WireGuard –ö–ª–∏–µ–Ω—Ç—ã:</b>\n<a href=\"{{ config.apk.wireguard_and }}\">üõ°Ô∏è Android</a> | <a href=\"{{ config.apk.wireguard_ios }}\">üõ°Ô∏è iOS</a>\n\nüíº <b>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –∑–∞—â–∏—Ç–∞ –±–µ–∑ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å–æ–≤!</b>\n\n‚ùì <b>–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?</b> –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É —á–µ—Ä–µ–∑ <a href=\"{{ config.support.link }}\">—ç—Ç–æ—Ç —á–∞—Ç</a>.",
        "reply_markup": {
            "keyboard": [
                [ { "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é" } ],
                [ { "text": "üë§ –ü—Ä–æ—Ñ–∏–ª—å" } ],
                [
                    { "text": "üí∞ –ë–∞–ª–∞–Ω—Å" },
                    { "text": "üîë –°–ø–∏—Å–æ–∫ VPN –∫–ª—é—á–µ–π" }
                ],
                [ { "text": "üìÑ –û –°–µ—Ä–≤–∏—Å–µ" } ],
                [
                    { "text": "üë• –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞" },
                    { "text": "‚ùì –ü–æ–º–æ—â—å" }
                ],
                {{ IF message.chat.id == config.telegram_admin.id }}
                [ { "text": "üì° –ê–¥–º–∏–Ω–∫–∞", "callback_data": "/qadminmenu" } ],
                {{ END }}
                [ { "text": "üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –£—Å–ª—É–≥–∏" } ]
            ],
            "one_time_keyboard": false,
            "resize_keyboard": true
        }
    }
}


<% CASE ['/payment', 'üí∞ –ë–∞–ª–∞–Ω—Å'] %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendPhoto": {
        "photo": "https://appleinsider.ru/wp-content/uploads/2022/04/vpn_app_screenshot.jpg",
        "protect_content": true,
        "parse_mode": "HTML",
        "caption": "üí∞ <b>–í–∞—à –±–∞–ª–∞–Ω—Å:</b> {{ user.balance }}\n\nüí≥ <b>–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø–ª–∞—Ç–∏—Ç—å:</b> <b>{{ user.pays.forecast('blocked', 1).total }}</b>\n\n–î–ª—è –æ–ø–ª–∞—Ç—ã –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂–µ.",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üëõ –û–ø–ª–∞—Ç–∏—Ç—å —Å–µ–π—á–∞—Å",
                        "web_app": {
                            "url": "{{ config.api.url }}/shm/v1/template/tg_payments?format=html&session_id={{ user.gen_session.id }}"
                        }
                    }
                ],
                [
                    {
                        "text": "‚ò∞ –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π",
                        "callback_data": "/pays"
                    }
                ],
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}


<% CASE ['/promocode', 'üíº –ü—Ä–æ–º–æ–∫–æ–¥—ã'] %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendPhoto": {
        "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
        "protect_content": true,
        "parse_mode": "HTML",
        "caption": "üíº <b>–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∞—à –±–æ–Ω—É—Å —Å –ø—Ä–æ–º–æ–∫–æ–¥–æ–º:</b>\n\n–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥ –Ω–∏–∂–µ –∏ –ø–æ–ª—É—á–∏—Ç–µ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –±–æ–Ω—É—Å—ã –Ω–∞ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç. –õ–µ–≥–∫–æ –∏ –±—ã—Å—Ç—Ä–æ! üöÄ\n\n<b>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</b> –ü—Ä–æ–º–æ–∫–æ–¥ –∞–∫—Ç–∏–≤–µ–Ω –Ω–∞ –≤—Å–µ –Ω–∞—à–∏ —É—Å–ª—É–≥–∏.",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üé´ –í–≤–µ—Å—Ç–∏ –ø—Ä–æ–º–æ–∫–æ–¥",
                        "web_app": {
                            "url": "{{ config.api.url }}/shm/v1/template/promo?format=html&session_id={{ user.gen_session.id }}"
                        }
                    }
                ],
                [
                    {
                        "text": "üìù –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤",
                        "callback_data": "/promo_history"
                    }
                ],
                [
                    {
                        "text": "üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}




<% CASE '/promo_history' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "üìú <b>–ò—Å—Ç–æ—Ä–∏—è –≤–∞—à–∏—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤:</b>\n\nüéüÔ∏è –ü—Ä–æ–º–æ–∫–æ–¥—ã, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤–∞–º:\n{{ promo.settings.tariff | default('–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤') }}\n\nüí° <i>–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–º–æ–∫–æ–¥ –∏–ª–∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é.</i>",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üé´ –í–≤–µ—Å—Ç–∏ –Ω–æ–≤—ã–π –ø—Ä–æ–º–æ–∫–æ–¥",
                        "web_app": {
                            "url": "{{ config.api.url }}/shm/v1/template/promo?format=html&session_id={{ user.gen_session.id }}"
                        }
                    }
                ],
                [
                    {
                        "text": "üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}



<% CASE ['/pays', '–ò—Å—Ç–æ—Ä–∏—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π'] %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendPhoto": {
        "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
        "protect_content": true,
        "parse_mode": "HTML",
        "caption": "üí≥ <b>–ò—Å—Ç–æ—Ä–∏—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π</b> üßæ\n\nüìÖ <i>–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ.</i>\n\nüîΩ <b>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ:</b>\n\n{{ FOR item IN ref(user.pays.list_for_api('limit', 1)) }}\n<u>üìÖ <b>–î–∞—Ç–∞:</b> {{ item.date }} | üíµ <b>–°—É–º–º–∞:</b> {{ item.money }} —Ä—É–±.</u>\n{{ END }}\n\n<b>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π:</b>",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é",
                        "callback_data": "/pays"
                    }
                ],
                [
                    {
                        "text": "üìä –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",
                        "callback_data": "/payment_stats"
                    }
                ],
                [
                    {
                        "text": "üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}

<% CASE '/payment_stats' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendPhoto": {
        "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
        "protect_content": true,
        "parse_mode": "HTML",
        "caption": "üìÖ <b>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è:</b>\n\n{{ FOR item IN ref(user.pays.list_for_api('limit', 5)) }}\n<u>üìÖ <b>–î–∞—Ç–∞:</b> {{ item.date }} | üíµ <b>–°—É–º–º–∞:</b> {{ item.money }} —Ä—É–±.</u>\n{{ END }}\n\nüîΩ <b>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:</b>",
        "reply_markup": {
            "inline_keyboard": [
			
                [
                    {
                        "text": "üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É",
                        "callback_data": "/payment_stats"
                    }
                ],
                [
                    {
                        "text": "üí≥ –ò—Å—Ç–æ—Ä–∏—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–π",
                        "callback_data": "/pays"
                    }
                ],
                [
                    {
                        "text": "üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}



<% CASE ['/list', 'üîë –°–ø–∏—Å–æ–∫ VPN –∫–ª—é—á–µ–π'] %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendPhoto": {
    "photo": "https://sun9-61.userapi.com/impg/sQ9q2iREoajKuCSBrCSacNXufXL2aNNiu5ErSA/daGUFUgXdXQ.jpg?size=1024x1024&quality=95&sign=b3f484f568e245a7199f8269980d42fb&type=album",
    "caption": "üöÄ <b>–ü—Ä–∏–≤–µ—Ç, {{ user.full_name }}!</b>\n\n–í—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª—é—á –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–ª–∏ –ø—Ä–æ–¥–ª–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π? –ú—ã –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å –≤–∞–º —Å —ç—Ç–∏–º!\n\nüíº **–°–∫–∞—á–∞–π—Ç–µ –Ω—É–∂–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**:\n\nüîπ <a href=\"{{ config.apk.android }}\">üåê **MrzbCLI VPN –¥–ª—è Android** üåê</a>\nüîπ <a href=\"{{ config.apk.ios }}\">üåê **MrzbCLI VPN –¥–ª—è iOS** üåê</a>\n\nüîπ <a href=\"{{ config.apk.wireguard_and }}\">üåê **WireGuard –¥–ª—è Android** üåê</a>\nüîπ <a href=\"{{ config.apk.wireguard_ios }}\">üåê **WireGuard –¥–ª—è iOS** üåê</a>\n\n–ü—Ä–æ—Å—Ç–æ —Å–∫–∞—á–∞–π—Ç–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∏ –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è!",
    "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "‚úö –ö—É–ø–∏—Ç—å –Ω–æ–≤—ã–π –∫–ª—é—á",
                        "callback_data": "/pricelist"
                    }
                ],
                 {{ SET categories = ['vpn-lt-mz', 'vpn-sw-mz', 'vpn-lt-wireguard', 'vpn-spain-mz'] }}
                {{ FOR category IN categories }}
                    {{ FOR item IN ref(user.services.list_for_api('category', category)) }}
                {{ SWITCH item.status }}
                    {{ CASE 'ACTIVE' }}
                        {{ icon = '‚úÖ' }}
                        {{ status = '–†–∞–±–æ—Ç–∞–µ—Ç' }}
                    {{ CASE 'BLOCK' }}
                        {{ icon = '‚ùå' }}
                        {{ status = '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞' }}
                    {{ CASE 'NOT PAID' }}
                        {{ icon = 'üí∞' }}
                        {{ status = '–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã' }}
                    {{ CASE }}
                        {{ icon = '‚è≥' }}
                        {{ status = '–û–±—Ä–∞–±–æ—Ç–∫–∞' }}
                {{ END }}
                [
                    {
                        "text": "{{ item.name }} - {{ icon }} {{ status }}",
                        "callback_data": "/service {{ item.user_service_id }}"
                    }
                ],
                         {{ END }}
                {{ END }}
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}

<% CASE '/service' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{{ us = user.services.list_for_api('usi', args.0) }}
{
    "sendPhoto": {
        {{ SWITCH us.status }}
          {{ CASE 'ACTIVE' }}
              {{ icon = '‚úÖ' }}
              {{ status = '–†–∞–±–æ—Ç–∞–µ—Ç' }}
          {{ CASE 'BLOCK' }}
              {{ icon = '‚ùå' }}
              {{ status = '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞' }}
          {{ CASE 'NOT PAID' }}
              {{ icon = 'üí∞' }}
              {{ status = '–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã' }}
          {{ CASE }}
              {{ icon = '‚è≥' }}
              {{ status = '–û–±—Ä–∞–±–æ—Ç–∫–∞' }}
        {{ END }}
        "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
        "caption": "<b>–£—Å–ª—É–≥–∞:</b> {{ us.name }}{{ IF us.expire }}\n\n<b>–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –¥–æ:</b> {{ us.expire }}{{ END }}\n\n<b>–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:</b> {{ icon }} {{ status }}{{ IF us.status == 'PROGRESS' }}\n\n<b>–û–∂–∏–¥–∞–µ–º–∞—è –¥–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:</b> {{ end_date }}{{ END }}{{ IF args.0 }}\n\n‚åõÔ∏è <b>–í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ {{ IF args.0 == 1 }}1 –¥–µ–Ω—å{{ ELSIF args.0 >= 2 AND args.0 <= 4 }}{{ args.0 }} –¥–Ω—è{{ ELSE }}{{ args.0 }} –¥–Ω–µ–π{{ END }}!</b>{{ END }}\n\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                {{ IF us.status == 'ACTIVE' }}
                {{ subscription_url = storage.read('name', 'vpn_mrzb_' _ args.0).subscription_url }}
                {{ IF us.category.grep('^(vpn-lt-mz|vpn-sw-mz|vpn-spain-mz)').first }}
                {{ IF subscription_url.grep('^https:').first }}
                [
                    {
                        "text": "üîë –ü–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è",
                        "web_app": {
                            "url": "{{ subscription_url }}"
                        }
                    }
                ],
                [
                    {
                        "text": "üîó –ü–æ–∫–∞–∑–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É",
                        "callback_data": "/show_mz_keys {{ args.0 }}"
                    }
                ],
                {{ ELSE }}
                [
                    {
                        "text": "‚ö†Ô∏è –û–®–ò–ë–ö–ê: –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ SSL –¥–ª—è Marzban",
                        "callback_data": "/menu"
                    }
                ],
                {{ END }}
                {{ ELSE }}
                [
                    {
                        "text": "üóù –°–∫–∞—á–∞—Ç—å –∫–ª—é—á",
                        "callback_data": "/download_qr {{ args.0 }}"
                    },
                    {
                        "text": "üëÅ –ü–æ–∫–∞–∑–∞—Ç—å QR –∫–æ–¥",
                        "callback_data": "/show_qr {{ args.0 }}"
                    }
                ],
                {{ END }}
                {{ END }}
                  {{ IF us.status == 'NOT PAID' || us.status == 'BLOCK' }}
                [
                    {
                        "text": "üí≥ –û–ø–ª–∞—Ç–∏—Ç—å —Å–µ–π—á–∞—Å",
                        "callback_data": "/payment {{ user.pays.forecast('blocked', 1).total }}"
                    }
                ],
                {{ END }}
                {{ IF us.status != 'PROGRESS' }}
                [
                    {
                        "text": "üóë –£–¥–∞–ª–∏—Ç—å —É—Å–ª—É–≥—É",
                        "callback_data": "/delete {{ args.0 }}"
                    }
                ],
                {{ END }}
                [
                    {
                        "text": "üîç –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ VPN",
                        "callback_data": "/xray"
                    }
                ],
                [
                    {
                        "text": "‚Ü©Ô∏è –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É —É—Å–ª—É–≥",
                        "callback_data": "/list"
                    }
                ]
            ]
        }
    }
}


<% CASE ['/pricelist', 'üöÄ –ü—Ä–∞–π—Å –ª–∏—Å—Ç'] %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendPhoto": {
        "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
        "protect_content": true,
        "parse_mode": "HTML",
        "caption": "üí°<b>–ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ VPN –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã—Ö —à–∞–≥–æ–≤:</b>\n\n1Ô∏è‚É£ <b>–í—ã–±–µ—Ä–∏—Ç–µ –∏–¥–µ–∞–ª—å–Ω—ã–π —Ç–∞—Ä–∏—Ñ:</b> –ü–æ–¥–±–µ—Ä–∏—Ç–µ –ø–ª–∞–Ω, –∫–æ—Ç–æ—Ä—ã–π –∏–¥–µ–∞–ª—å–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–∞—à–∏–º –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è–º.\n\n2Ô∏è‚É£ <b>–û—Ñ–æ—Ä–º–∏—Ç–µ –æ–ø–ª–∞—Ç—É:</b> –£–¥–æ–±–Ω–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ –æ–ø–ª–∞—Ç–∏—Ç–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∞—Ä–∏—Ñ —Å –ø–æ–º–æ—â—å—é –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤.\n\n3Ô∏è‚É£ <b>–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ VPN:</b> –°–ª–µ–¥—É–π—Ç–µ –ø–æ—à–∞–≥–æ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –Ω–∞ –≤–∞—à–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ. üõ†Ô∏è\n\nüöÄ<b>–û—Ç–∑—ã–≤—ã –Ω–∞—à–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</b>\nüèéÔ∏è <i>–í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –¥–∞–∂–µ –∑–∞ –≥—Ä–∞–Ω–∏—Ü–µ–π!</i>\nüîí <i>–ê–±—Å–æ–ª—é—Ç–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ—Å—Ç–æ—Ç–∞ –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ ‚Äì VPN, –∫–æ—Ç–æ—Ä–æ–º—É –º–æ–∂–Ω–æ –¥–æ–≤–µ—Ä—è—Ç—å.</i>\n\nüîΩ <b>–ù–µ —Ç–µ—Ä—è–π—Ç–µ –≤—Ä–µ–º–µ–Ω–∏ ‚Äì –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ –∏ –Ω–∞—á–Ω–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è VPN –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!</b>",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üåê –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É –¥–ª—è –∑–∞–∫–∞–∑–∞",
                        "callback_data": "/service_choice"
                    }
                ],
                [
                    {
                        "text": "üîê VPN –£—Å–ª—É–≥–∏ üåü",
                        "callback_data": "/buy_mz_key"
                    },
                    {
                        "text": "üîí WireGuard –£—Å–ª—É–≥–∏ üåü",
                        "callback_data": "/buy_wg_key"
                    }
                ],
                [
                    {
                        "text": "üìã –ú–æ–∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–ª—é—á–∏",
                        "callback_data": "/list"
                    }
                ],
                [
                    {
                        "text": "üí¨ –ü–æ–º–æ—â—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞",
                        "callback_data": "/support"
                    }
                ],
                [
                    {
                        "text": "‚Ü©Ô∏è –ù–∞–∑–∞–¥ –∫ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}


<% CASE '/buy_mz_key' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "üåê <b>–ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ VPN:</b>\n\n1Ô∏è‚É£ <b>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ:</b> –ü–æ–¥–±–µ—Ä–∏—Ç–µ –∏–¥–µ–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–∞—à–∏–º –Ω—É–∂–¥–∞–º.\n\n2Ô∏è‚É£ <b>–û–ø–ª–∞—Ç–∏—Ç–µ:</b> –ü—Ä–æ–∏–∑–≤–µ–¥–∏—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–ª–∞—Ç—ë–∂ —É–¥–æ–±–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º.\n\n3Ô∏è‚É£ <b>–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ:</b> –ü–æ–ª—É—á–∏—Ç–µ –∫–ª—é—á –∏ —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è. üõ†Ô∏è\n\nüöÄ <b>–ü–æ—á–µ–º—É –≤—ã–±–∏—Ä–∞—é—Ç –Ω–∞—Å:</b>\nüîí <i>–í—ã—Å–æ–∫–∞—è –∑–∞—â–∏—Ç–∞ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö</i>\nüèéÔ∏è <i>–ë—ã—Å—Ç—Ä–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</i>\nüì∂ <i>–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É</i>\n\n‚ú® <b>–í—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–π —Ç–∞—Ä–∏—Ñ –∏ –Ω–∞—á–Ω–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è VPN –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!</b>",
        "reply_markup": {
            "inline_keyboard": [
				
                {{ FOR item IN ref(service.api_price_list).nsort('service_id') }}
					{{ IF item.category == 'vpn-sw-mz' or item.category == 'vpn-lt-mz' or item.category == 'vpn-spain-mz' }}
                    [
                        {
                            "text": "{{ item.name }} - {{ item.cost }} —Ä—É–±/–º–µ—Å. üåü",
                            "callback_data": "/serviceorder {{ item.service_id }}"
                        }
                    ],
                    {{ END }}
                {{ END }}
                [
                    {
                        "text": "‚Ü©Ô∏è –ù–∞–∑–∞–¥ –∫ —Ç–∞—Ä–∏—Ñ–∞–º",
                        "callback_data": "/pricelist"
                    }
                ]
            ]
        }
    }
}


<% CASE '/buy_wg_key' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "üåê <b>–ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ WireGuard:</b>\n\n1Ô∏è‚É£ <b>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ:</b> –ù–∞–π–¥–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–ª–∞–Ω, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–∞—à–∏–º –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è–º.\n\n2Ô∏è‚É£ <b>–û–ø–ª–∞—Ç–∏—Ç–µ:</b> –ü—Ä–æ–∏–∑–≤–µ–¥–∏—Ç–µ –ø–ª–∞—Ç—ë–∂ —É–¥–æ–±–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º.\n\n3Ô∏è‚É£ <b>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:</b> –ü–æ–ª—É—á–∏—Ç–µ –∫–ª—é—á –∏ —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è. üõ†Ô∏è\n\nüöÄ <b>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ WireGuard:</b>\nüîí <i>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö</i>\n‚ö° <i>–í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã</i>\nüåç <i>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É</i>\n\n‚ú® <b>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ –∏ –Ω–∞—á–Ω–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è WireGuard —É–∂–µ —Å–µ–≥–æ–¥–Ω—è!</b>",
        "reply_markup": {
            "inline_keyboard": [
                {{ FOR item IN ref(service.api_price_list).nsort('service_id') }}
                    {{ IF item.category == 'vpn-sw-wireguard' or item.category == 'vpn-lt-wireguard' }}
                    [
                        {
                            "text": "{{ item.name }} - {{ item.cost }} —Ä—É–±/–º–µ—Å. üåü",
                            "callback_data": "/serviceorder {{ item.service_id }}"
                        }
                    ],
                    {{ END }}
                {{ END }}
                [
                    {
                        "text": "‚Ü©Ô∏è –ù–∞–∑–∞–¥ –∫ —Ç–∞—Ä–∏—Ñ–∞–º",
                        "callback_data": "/pricelist"
                    }
                ]
            ]
        }
    }
}


<% CASE '/show_mz_keys' %>
{{ location = storage.read('name', 'vpn_mrzb_' _ args.0).location }}
{{ subscription_url = storage.read('name', 'vpn_mrzb_' _ args.0 _ location).subscription_url }}
{
    "sendPhoto": {
        "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
        "protect_content": true,
        "parse_mode": "HTML",
        "caption": "üåê <b>–í–∞—à–∏ VPN –∫–ª—é—á–∏ –∏ –ø–æ–¥–ø–∏—Å–∫–∞:</b>\n\nüîó <b>URL –ø–æ–¥–ø–∏—Å–∫–∏:</b>\n<code>{{ subscription_url }}</code>\n\nüí° <i>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç URL –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –≤–∞—à–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.</i>\n\nüîê <b>–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª—é—á –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è:</b>",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üîë Trojan TCP",
                        "callback_data": "/trojan_key {{ args.0 }}"
                    },
                    {
                        "text": "üîë VLESS GRPC",
                        "callback_data": "/vless_key {{ args.0 }}"
                    }
                ],
                [
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —É—Å–ª—É–≥–∞–º",
                        "callback_data": "/service {{ args.0 }}"
                    }
                ]
            ]
        }
    }
}

<% CASE '/vless_key' %>
{{ vless_tcp = storage.read('name', 'vpn_mrzb_' _ args.0).links.grep('^vless:').first }}

{
    "printQrCode": {
        "data": "{{ vless_tcp }}",
        "parameters": {
            "parse_mode": "HTML",
            "caption": "‚úÖ <b>–í–∞—à VLESS TCP –∫–ª—é—á —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω!</b>\n\nüì• <i>QR-–∫–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.</i>"
        }
    }
},
{
    "sendMessage": {
        "text": "üîë <b>–í–∞—à VLESS TCP –∫–ª—é—á</b>\n\nüåê <b>–ü—Ä–æ—Ç–æ–∫–æ–ª:</b> VLESS TCP\n\nüóùÔ∏è <b>–ö–ª—é—á:</b> <code>{{ vless_tcp }}</code>\n\nüì≤ <i>–°–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR-–∫–æ–¥ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—à–µ–≥–æ VPN –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.</i>\n\nüí° <b>–°–æ–≤–µ—Ç:</b> –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–æ—Ç –∫–ª—é—á –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ.",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –∫–ª—é—á–∞–º",
                        "callback_data": "/show_mz_keys {{ args.0 }}"
                    }
                ]
            ]
        }
    }
}

<% CASE '/trojan_key' %>
{{ trojan = storage.read('name', 'vpn_mrzb_' _ args.0).links.grep('^trojan:').first }}

{
    "printQrCode": {
        "data": "{{ trojan }}",
        "parameters": {
            "parse_mode": "HTML",
            "caption": "‚úÖ <b>–í–∞—à Trojan TCP –∫–ª—é—á —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω!</b>\n\nüîí <i>QR-–∫–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.</i>\n\nüí° <b>–ù–µ –∑–∞–±—É–¥—å—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–ª—é—á –≤ –Ω–∞–¥–µ–∂–Ω–æ–º –º–µ—Å—Ç–µ.</b>"
        }
    }
},
{
    "sendMessage": {
        "text": "üîë <b>–í–∞—à Trojan TCP –∫–ª—é—á</b>\n\n<b>–ü—Ä–æ—Ç–æ–∫–æ–ª:</b> Trojan TCP\n\nüóù<b>–ö–ª—é—á:</b> <code>{{ trojan }}</code>\n\nüì≤ <i>–°–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR-–∫–æ–¥ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—à–µ–≥–æ VPN –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.</i>\n\nüí° <b>–°–æ–≤–µ—Ç:</b> –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≤–∞—à–µ–º—É VPN-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—é.\n\nüîí <b>–ß—Ç–æ —Ç–∞–∫–æ–µ Trojan?</b>\nTrojan ‚Äî —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∏ –±—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏ –∑–∞—â–∏—Ç—ã –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏. –≠—Ç–æ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Å—Ç—Ä–∞–Ω–∞—Ö —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Ä–µ—Å—É—Ä—Å–∞–º.",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –∫–ª—é—á–∞–º",
                        "callback_data": "/show_mz_keys {{ args.0 }}"
                    }
                ]
            ]
        }
    }
}



<% CASE '/serviceorder' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "shmServiceOrder": {
        "service_id": "{{ args.0 }}",
        "callback_data": "/list",
        "cb_not_enough_money": "/payment",
        "error": "–û–®–ò–ë–ö–ê"
    }
}

<% CASE '/download_qr' %>
{
    "uploadDocumentFromStorage": {
        "name": "vpn{{ args.0 }}",
        "filename": "vpn{{ args.0 }}.conf"
    }
}

<% CASE '/show_qr' %>
{
    "uploadPhotoFromStorage": {
        "name": "vpn{{ args.0 }}",
        "format": "qr_code_png"
    }
}

<% CASE '/delete' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "‚ö†Ô∏è <b>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è —É—Å–ª—É–≥–∏</b>\n\nüóëÔ∏è <b>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —É—Å–ª—É–≥—É?</b>\n\n<i>–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ:</i> –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è —É—Å–ª—É–≥—É –Ω–µ–ª—å–∑—è –±—É–¥–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å.\n\n –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —ç—Ç–æ –≤–∞—à–µ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.\n\n–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å, –Ω–∞–∂–º–∏—Ç–µ <<–£–¥–∞–ª–∏—Ç—å —É—Å–ª—É–≥—É>>. –ï—Å–ª–∏ –≤—ã –ø–µ—Ä–µ–¥—É–º–∞–ª–∏, –Ω–∞–∂–º–∏—Ç–µ <<–û—Ç–º–µ–Ω–∞>>.",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —É—Å–ª—É–≥—É",
                        "callback_data": "/delete_confirmed {{ args.0 }}"
                    }
                ],
                [
                    {
                        "text": "üîô –û—Ç–º–µ–Ω–∞",
                        "callback_data": "/list"
                    }
                ]
            ]
        }
    }
}


<% CASE '/delete_confirmed' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "shmServiceDelete": {
        "usi": "{{ args.0 }}",
        "callback_data": "/list",
        "error": "–û–®–ò–ë–ö–ê"
    }
}


<% CASE ['/test', 'üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –£—Å–ª—É–≥–∏'] %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendPhoto": {
        "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
        "protect_content": true,
        "parse_mode": "HTML",
        "caption": "üì≤ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ VPN —É—Å–ª—É–≥**\n\n<b>–í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞:</b>\n\n<b>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:</b>\n1. **–í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å:** –û–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ VPN —Ä–µ—à–µ–Ω–∏—è–º–∏.\n2. **–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ –Ω–∏–∂–µ, —á—Ç–æ–±—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ.\n\n<b>–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —É—Å–ª—É–≥–∏:</b>\n- üîë **VPN:** –°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ —Å–µ—Ä—Ñ–∏–Ω–≥–∞.\n- üîë **WireGuard:** –í—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω–æ–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π VPN.\n\nüëç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ—Ç–º–µ—á–∞—é—Ç –æ—Ç–ª–∏—á–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è —Å–∞–º–∏.",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üöÄ –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö —É—Å–ª—É–≥",
                        "callback_data": "/beta_test"
                    }
                ],
                [
                    {
                        "text": "üîë **–ó–∞–∫–∞–∑–∞—Ç—å VPN –¥–æ—Å—Ç—É–ø**",
                        "callback_data": "/test_mz"
                    },
                    {
                        "text": "üîë **–ó–∞–∫–∞–∑–∞—Ç—å WireGuard –¥–æ—Å—Ç—É–ø**",
                        "callback_data": "/test_wireguard"
                    }
                ],
                [
                    {
                        "text": "üîô –ù–∞–∑–∞–¥",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}



<% CASE ['/test_wireguard', 'üåê WireGuard Test'] %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendPhoto": {
        "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
        "protect_content": true,
        "parse_mode": "HTML",
        "caption": "üåê **WireGuard (Beta) - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**\n\nüöÄ **–ß—Ç–æ —Ç–∞–∫–æ–µ WireGuard?**\nWireGuard ‚Äî —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π, –±—ã—Å—Ç—Ä—ã–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π VPN-–ø—Ä–æ—Ç–æ–∫–æ–ª, –∫–æ—Ç–æ—Ä—ã–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω—É—é –∑–∞—â–∏—Ç—É –≤–∞—à–µ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.\n\nüîç **–ö–∞–∫ –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ?**\n1. **–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ:** –û–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Ç–∞—Ä–∏—Ñ–∞–º–∏ –Ω–∏–∂–µ.\n2. **–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ —Ç–µ—Å—Ç:** –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π —Ç–∞—Ä–∏—Ñ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.\n\nüí∞ **–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã:**",
        "reply_markup": {
            "inline_keyboard": [
                {{ 
                    services = ref(service.api_price_list('category', 'vpn-lt-wg-beta'));
                }}
                {{ FOR item IN services }}
                [
                    {
                        "text": "üåê {{ item.name }} - {{ item.cost }} —Ä—É–±/–º–µ—Å.",
                        "callback_data": "/serviceorder {{ item.service_id }} 1"
                    }
                ],
                {{ END }}
                [
                    {
                        "text": "üöÄ –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö —É—Å–ª—É–≥",
                        "callback_data": "/beta_test"
                    }
                ],
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}

<% CASE ['/test_mz', 'üåê MZ Test'] %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendPhoto": {
        "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
        "protect_content": true,
        "parse_mode": "HTML",
        "caption": "üåê **MZ (Beta) - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**\n\nüöÄ **–ß—Ç–æ —Ç–∞–∫–æ–µ MZ?**\nMZ ‚Äî —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ —Å–µ—Ä—Ñ–∏–Ω–≥–∞, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–µ–µ –≤—ã—Å–æ–∫—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–∞—à–µ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.\n\nüîç **–ö–∞–∫ –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ?**\n1. **–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ:** –û–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Ç–∞—Ä–∏—Ñ–∞–º–∏ –Ω–∏–∂–µ.\n2. **–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ —Ç–µ—Å—Ç:** –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π —Ç–∞—Ä–∏—Ñ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.\n\nüí∞ **–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã:**",
        "reply_markup": {
            "inline_keyboard": [
                {{ FOR item IN ref(service.api_price_list).nsort('service_id') }}
                    {{ IF item.category.grep('^(vpn-sw-mz-beta|vpn-lt-mz-beta|vpn-isp-mz-beta)').first }}
                    [
                        {
                            "text": "üåê {{ item.name }} - {{ item.cost }} —Ä—É–±/–º–µ—Å.",
                            "callback_data": "/serviceorder {{ item.service_id }} 1"
                        }
                    ],
                    {{ END }}
                {{ END }}
                [
                    {
                        "text": "üöÄ –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö —É—Å–ª—É–≥",
                        "callback_data": "/beta_test"
                    }
                ],
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}

<% CASE ['/beta_test', 'üöÄ –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö —É—Å–ª—É–≥'] %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "üöÄ <b>{{ user.full_name }}!</b> –í–æ—Ç —Å–ø–∏—Å–æ–∫ –≤–∞—à–∏—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö —É—Å–ª—É–≥. –í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–ª–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –∫–ª—é—á–∏ –∏–ª–∏ –∫—É–ø–∏—Ç—å –Ω–æ–≤—ã–µ. üòä\n\nüèÖ **–°–∫–∞—á–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**\n ‚îú <a href=\"{{ config.apk.android }}\">üåê {{ config.company.name }} Android</a>\n ‚îî <a href=\"{{ config.apk.ios }}\">üåê {{ config.company.name }} iOS</a>\n\n ‚îú <a href=\"{{ config.apk.wireguard_and }}\">üåê Wireguard Android</a>\n ‚îî <a href=\"{{ config.apk.wireguard_ios }}\">üåê Wireguard iOS</a>\n\nüîç **–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —É—Å–ª—É–≥–∏ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è:**",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üì° **–ö–ª—é—á–∏ VPN**",
                        "callback_data": "/test_services_mz"
                    },
                    {
                        "text": "üîê **–ö–ª—é—á–∏ WireGuard**",
                        "callback_data": "/test_services_wg"
                    }
                ],
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/test"
                    }
                ]
            ]
        }
    }
}

<% CASE '/test_services_wg' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
		"text": "üìã <b>–¢–µ—Å—Ç–æ–≤—ã–µ —É—Å–ª—É–≥–∏ Wireguard:</b>\n\nüåü **–ò—Å–ø—ã—Ç–∞–π—Ç–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ Wireguard!** üåü\n\nWireguard –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤–∞–º —É–Ω–∏–∫–∞–ª—å–Ω—É—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∞–º—ã–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –∑–∞—â–∏—Ç—ã –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –≤—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –Ω–∞—à–∏–º —Ç–µ—Å—Ç–æ–≤—ã–º —É—Å–ª—É–≥–∞–º –∏ –æ—Ü–µ–Ω–∏—Ç–µ –∏—Ö –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ!\n\n**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —É—Å–ª—É–≥–∏:**\n\n",
        "reply_markup": {
            "inline_keyboard": [
                {{ SET categories = ['vpn-sw-wg-beta', 'vpn-lt-wg-beta'] }}
                {{ FOR category IN categories }}
                    {{ FOR item IN ref(user.services.list_for_api('category', category)) }}
                        {{ SWITCH item.status }}
                            {{ CASE 'ACTIVE' }}
                                {{ icon = '‚úÖ' }}
                                {{ status = '–†–∞–±–æ—Ç–∞–µ—Ç' }}
                            {{ CASE 'BLOCK' }}
                                {{ icon = '‚ùå' }}
                                {{ status = '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞' }}
                            {{ CASE 'NOT PAID' }}
                                {{ icon = 'üí∞' }}
                                {{ status = '–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã' }}
                            {{ CASE }}
                                {{ icon = '‚è≥' }}
                                {{ status = '–û–±—Ä–∞–±–æ—Ç–∫–∞' }}
                        {{ END }}
                        [
                            {
                                "text": "{{ item.name }} - {{ icon }} {{ status }}",
                                "callback_data": "/service_beta {{ item.user_service_id }}"
                            }
                        ],
                    {{ END }}
                {{ END }}
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/beta_test"
                    }
                ]
            ]
        }
    }
}

<% CASE '/test_services_mz' %> 
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "üìã <b>–¢–µ—Å—Ç–æ–≤—ã–µ —É—Å–ª—É–≥–∏ VPN:</b>\n\nüåü **–ò—Å–ø—ã—Ç–∞–π—Ç–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ PROXY!** üåü\n\nVPN –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤–∞–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. –ü–æ–¥–∫–ª—é—á–∞–π—Ç–µ—Å—å –∫ —Ç–µ—Å—Ç–æ–≤—ã–º —É—Å–ª—É–≥–∞–º –∏ —É–±–µ–¥–∏—Ç–µ—Å—å –≤ –∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏!\n\n**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —É—Å–ª—É–≥–∏:**\n\n",
        "reply_markup": {
            "inline_keyboard": [
                {{ SET categories = ['vpn-lt-mz-beta', 'vpn-sw-mz-beta'] }}
                {{ FOR category IN categories }}
                    {{ FOR item IN ref(user.services.list_for_api('category', category)) }}
                        {{ SWITCH item.status }}
                            {{ CASE 'ACTIVE' }}
                                {{ icon = '‚úÖ' }}
                                {{ status = '–†–∞–±–æ—Ç–∞–µ—Ç' }}
                            {{ CASE 'BLOCK' }}
                                {{ icon = '‚ùå' }}
                                {{ status = '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞' }}
                            {{ CASE 'NOT PAID' }}
                                {{ icon = 'üí∞' }}
                                {{ status = '–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã' }}
                            {{ CASE }}
                                {{ icon = '‚è≥' }}
                                {{ status = '–û–±—Ä–∞–±–æ—Ç–∫–∞' }}
                        {{ END }}
                        [
                            {
                                "text": "{{ item.name }} - {{ icon }} {{ status }}",
                                "callback_data": "/service_beta {{ item.user_service_id }}"
                            }
                        ],
                    {{ END }}
                {{ END }}
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/beta_test"
                    }
                ]
            ]
        }
    }
}

<% CASE '/service_beta' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{{ us = user.services.list_for_api('usi', args.0) }}
{
    "sendPhoto": {
        {{ SWITCH us.status }}
          {{ CASE 'ACTIVE' }}
              {{ icon = '‚úÖ' }}
              {{ status = '–†–∞–±–æ—Ç–∞–µ—Ç (—Ç–µ—Å—Ç)' }}
          {{ CASE 'BLOCK' }}
              {{ icon = '‚ùå' }}
              {{ status = '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ (—Ç–µ—Å—Ç)' }}
          {{ CASE 'NOT PAID' }}
              {{ icon = 'üí∞' }}
              {{ status = '–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã (—Ç–µ—Å—Ç)' }}
          {{ CASE }}
              {{ icon = '‚è≥' }}
              {{ status = '–û–±—Ä–∞–±–æ—Ç–∫–∞ (—Ç–µ—Å—Ç)' }}
        {{ END }}
        "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
        "caption": "<b>–£—Å–ª—É–≥–∞:</b> {{ us.name }} (—Ç–µ—Å—Ç){{ IF us.expire }}\n\n<b>–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –¥–æ:</b> {{ us.expire }}{{ END }}\n\n<b>–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:</b> {{ icon }} {{ status }}{{ IF us.status == 'PROGRESS' }}\n\n<b>–û–∂–∏–¥–∞–µ–º–∞—è –¥–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:</b> {{ end_date }}{{ END }}\n\n",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                {{ IF us.status == 'ACTIVE' }}
                {{ subscription_url = storage.read('name', 'vpn_mrzb_' _ args.0).subscription_url }}
                {{ IF us.category.grep('^(vpn-lt-mz|vpn-sw-mz)').first }}
                {{ IF subscription_url.grep('^https:').first }}
                [
                    {
                        "text": "üîë –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è",
                        "web_app": {
                            "url": "{{ subscription_url }}"
                        }
                    }
                ],
                [
                    {
                        "text": "üîó –ü–æ–∫–∞–∑–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É",
                        "callback_data": "/show_mz_keys {{ args.0 }}"
                    }
                ],
                {{ ELSE }}
                [
                    {
                        "text": "‚ö†Ô∏è –û–®–ò–ë–ö–ê: –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ SSL –¥–ª—è Marzban",
                        "callback_data": "/menu"
                    }
                ],
                {{ END }}
                {{ ELSE }}
                [
                    {
                        "text": "üóù –°–∫–∞—á–∞—Ç—å –∫–ª—é—á",
                        "callback_data": "/download_qr {{ args.0 }}"
                    },
                    {
                        "text": "üëÅ –ü–æ–∫–∞–∑–∞—Ç—å QR –∫–æ–¥",
                        "callback_data": "/show_qr {{ args.0 }}"
                    }
                ],
                {{ END }}
                {{ END }}
                {{ IF us.status == 'NOT PAID' || us.status == 'BLOCK' }}
                [
                    {
                        "text": "üí≥ –û–ø–ª–∞—Ç–∏—Ç—å —Å–µ–π—á–∞—Å",
                        "callback_data": "/payment {{ user.pays.forecast('blocked', 1).total }}"
                    }
                ],
                {{ END }}
                {{ IF us.status != 'PROGRESS' }}
                [
                    {
                        "text": "üóë –£–¥–∞–ª–∏—Ç—å —É—Å–ª—É–≥—É",
                        "callback_data": "/delete {{ args.0 }}"
                    }
                ],
                {{ END }}
                [
                    {
                        "text": "‚Ü©Ô∏è –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É —É—Å–ª—É–≥",
                        "callback_data": "/list"
                    }
                ]
            ]
        }
    }
}

<% CASE 'üë• –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "ü§ù <b>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à—É —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É!</b>\n\nüì£ <b>–ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –ª–µ–≥–∫–æ!</b>\n\n–ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π—Ç–µ <b>{{ config.billing.partner.income_percent }}% –æ—Ç –∫–∞–∂–¥–æ–≥–æ –∏—Ö –ø–ª–∞—Ç–µ–∂–∞</b>. –≠—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–∞—Ç—å –ø–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥!\n\nüîó <b>–í–∞—à–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞:</b>\n<code>{{ config.tg_bot.url }}?start={{ user.id }}</code>\n\n–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å—Å—ã–ª–∫–æ–π —Å –¥—Ä—É–∑—å—è–º–∏ –∏ –Ω–∞—á–Ω–∏—Ç–µ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å! –ß–µ–º –±–æ–ª—å—à–µ –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã—Ö ‚Äî —Ç–µ–º –≤—ã—à–µ –≤–∞—à –¥–æ—Ö–æ–¥.\n\nüí° <b>–ü–æ—á–µ–º—É —Å—Ç–æ–∏—Ç —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å?</b>\n1Ô∏è‚É£ –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç —Å –ø–ª–∞—Ç–µ–∂–µ–π.\n2Ô∏è‚É£ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç–µ –¥—Ä—É–∑–µ–π, –ø–æ–º–æ–≥–∞—è –∏–º –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –Ω–∞—à–µ–º—É —Å–µ—Ä–≤–∏—Å—É.\n3Ô∏è‚É£ –í–∞—à –¥–æ—Ö–æ–¥ —Ä–∞—Å—Ç—ë—Ç —Å –∫–∞–∂–¥—ã–º –Ω–æ–≤—ã–º –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã–º!\n\nüì≤ <b>–ù–µ —Ç–µ—Ä—è–π—Ç–µ –≤—Ä–µ–º—è, –Ω–∞—á–Ω–∏—Ç–µ —É–∂–µ —Å–µ–≥–æ–¥–Ω—è!</b>",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π",
                        "switch_inline_query": "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ {{ config.company.name }}! –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π —Å –Ω–∞–º–∏ üõ° {{ config.tg_bot.url }}?start={{ user.id }}"
                    }
                ],
                [
                    {
                        "text": "üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ—Ö–æ–¥–æ–≤",
                        "callback_data": "/referral_stats"
                    },
                    {
                        "text": "‚ùì –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?",
                        "callback_data": "/referral_help"
                    }
                ],
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
<% CASE '/referral_stats' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "üìä <b>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∞—à–µ–π —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã</b>\n\nüë• <b>–í—Å–µ–≥–æ –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã—Ö:</b> {{ user.referrals_count }}\nüí≥ <b>–ü–ª–∞—Ç–µ–∂–µ–π –æ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤:</b> {{ user.get_bonus }}\n\nüîó <b>–í–∞—à–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞:</b>\n<code>{{ config.tg_bot.url }}?start={{ user.id }}</code>\n\nüìà <b>–ö–∞–∫ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ—Ö–æ–¥?</b>\n–ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –±–æ–ª—å—à–µ –¥—Ä—É–∑–µ–π –∏ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–π—Ç–µ –∏–º –æ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞—Ö –Ω–∞—à–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞. –ö–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤–∞—à—É –ø—Ä–∏–±—ã–ª—å!",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π",
                        "switch_inline_query": "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ {{ config.company.name }}! –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π —Å –Ω–∞–º–∏ üõ° {{ config.tg_bot.url }}?start={{ user.id }}"
                    }
                ],
                [
                    {
                        "text": "‚ùì –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –ø—Ä–æ–≥—Ä–∞–º–º–µ",
                        "callback_data": "/referral_help"
                    },
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}

<% CASE '/referral_help' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "üîç <b>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞?</b>\n\n–í –Ω–∞—à–µ–π —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å, –ø—Ä–∏–≥–ª–∞—à–∞—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ö–∞–∂–¥–æ–º—É –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω–æ–º—É –¥—Ä—É–≥—É –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω–∞—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –æ–Ω –º–æ–∂–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—à–∏ —É—Å–ª—É–≥–∏.\n\nüí∏ <b>–ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ:</b>\n–í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ <b>{{ config.billing.partner.income_percent }}%</b> –æ—Ç —Å—É–º–º—ã –∫–∞–∂–¥–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–≤–µ—Ä—à–∏—Ç –≤–∞—à –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã–π –¥—Ä—É–≥. –≠—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–π —Å–ø–æ—Å–æ–± –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ!\n\nüîó <b>–ö–∞–∫ –ø—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞:</b>\n1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞—à—É —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É.\n2. –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –µ—é —Å –¥—Ä—É–∑—å—è–º–∏ –∏–ª–∏ –∫–æ–ª–ª–µ–≥–∞–º–∏.\n3. –ö–æ–≥–¥–∞ –æ–Ω–∏ —Å–æ–≤–µ—Ä—à–∞—Ç –ø–µ—Ä–≤—ã–π –ø–ª–∞—Ç–µ–∂, –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —ç—Ç–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞.\n\nüí° <b>–°–æ–≤–µ—Ç—ã –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –¥–æ—Ö–æ–¥–∞:</b>\n1. –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å—Å—ã–ª–∫–æ–π —á–µ—Ä–µ–∑ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ –∏ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã.\n2. –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞—Ö –Ω–∞—à–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –∏ –±–æ–Ω—É—Å–∞—Ö –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.\n\n–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã, –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–∞—à–µ–π —Å–ª—É–∂–±–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏.\n\nüîó –í–∞—à–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞:\n<code>{{ config.tg_bot.url }}?start={{ user.id }}</code>",
        "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üéØ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π",
                        "switch_inline_query": "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ {{ config.company.name }} –∏ –ø–æ–ª—É—á–∞–π –±–æ–Ω—É—Å—ã! üõ° {{ config.tg_bot.url }}?start={{ user.id }}"
                    }
                ],
                [
                    {
                        "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}


<% CASE 'üìÑ –û –°–µ—Ä–≤–∏—Å–µ' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
    "text": "üöÄ <b>–û —Å–µ—Ä–≤–∏—Å–µ {{ config.company.name }}</b>\n\n<b>{{ config.company.name }}</b> ‚Äî –≤–∞—à –Ω–∞–¥–µ–∂–Ω—ã–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø—É—Ç–Ω–∏–∫ –≤ –º–∏—Ä–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. –ú—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –∏ –ø–æ–ª–Ω—É—é —Å–≤–æ–±–æ–¥—É –¥–µ–π—Å—Ç–≤–∏–π –æ–Ω–ª–∞–π–Ω! üåê\n\n<b>–ù–∞—à–∏ –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:</b>\n\nüîí <b>–ù–µ–ø—Ä–æ–±–∏–≤–∞–µ–º–∞—è –∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö:</b> <i>–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—â–∏—â–∞—é—Ç –≤–∞—à—É –ª–∏—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç –ø–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –≥–ª–∞–∑.</i>\nüåç <b>–î–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ç–µ–Ω—Ç—É –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É:</b> <i>50+ —Å–µ—Ä–≤–µ—Ä–æ–≤ –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –ª—é–±–æ–º—É –∫–æ–Ω—Ç–µ–Ω—Ç—É, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤–∞—à–µ–≥–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è.</i>\nüîë <b>–ê–±—Å–æ–ª—é—Ç–Ω–∞—è –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å:</b> <i>–ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –≤–∞—à–∏—Ö –æ–Ω–ª–∞–π–Ω-–¥–µ–π—Å—Ç–≤–∏–π. –í—ã –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –≥–¥–µ –±—ã –≤—ã –Ω–∏ –Ω–∞—Ö–æ–¥–∏–ª–∏—Å—å.</i>\n‚öôÔ∏è <b>–õ–µ–≥–∫–æ—Å—Ç—å –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏:</b> <i>–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –∫–∞–∂–¥–æ–º—É.</i>\n\n<b>{{ config.company.name }} VPN</b> ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–µ—Ä–≤–∏—Å, —ç—Ç–æ –≤–∞—à –∑–∞—â–∏—Ç–Ω–∏–∫ –≤ —Ü–∏—Ñ—Ä–æ–≤–æ–º –º–∏—Ä–µ! üîê\n\n<b>–î–æ–≤–µ—Ä—å—Ç–µ—Å—å –Ω–∞–º –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –æ–Ω–ª–∞–π–Ω!</b>",
    "parse_mode": "HTML",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üí∞ –£–∑–Ω–∞—Ç—å —Ç–∞—Ä–∏—Ñ—ã",
                        "callback_data": "/pricelist"
                    }
                ],
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}

<% CASE ['/support', '‚ùì –ü–æ–º–æ—â—å'] %>
{{ IF cmd == '/help' OR cmd == '‚ùì –ü–æ–º–æ—â—å' }}
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{{ END }}
{
    "sendMessage": {
        "text": "üì° <b>–ü–æ–º–æ—â—å –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</b>\n\n–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –≤–∞—Å –ø—É–Ω–∫—Ç –∏–∑ —Å–ø–∏—Å–∫–∞ –Ω–∏–∂–µ:",
        "parse_mode": "HTML",
        "reply_markup": {
            "keyboard": [
                [
                    {
                        "text": "üñ• –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ VPN"
                    },
                    {
                        "text": "üñ• –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ WireGuard"
                    }
                ],
                [
                    {
                        "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é"
                    }
                ]
            ],
            "one_time_keyboard": false,
            "resize_keyboard": true
        }
    }
}


<% CASE ['/xray', 'üñ• –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ VPN'] %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendPhoto": {
        "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
        "protect_content": true,
        "parse_mode": "HTML",
        "caption": "üõ°Ô∏è <b>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ VPN</b>\n\nüì± <b>–î–ª—è Android:</b>\n1Ô∏è‚É£ –°–∫–æ–ø–∏—Ä—É–π—Ç–µ <b>–∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞</b> (—Ñ–æ—Ä–º–∞—Ç <i>vless://</i>).\n2Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ <a href=\"{{ config.apk.android }}\">ServRU Android üåê</a>.\n3Ô∏è‚É£ –í—Å—Ç–∞–≤—å—Ç–µ –∫–ª—é—á –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.\n4Ô∏è‚É£ –ù–∞–∂–º–∏—Ç–µ <b>'–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è'</b> ‚Äî –≥–æ—Ç–æ–≤–æ!\n\nüì≤ <b>–î–ª—è iOS:</b>\n1Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ <a href=\"https://apps.apple.com/ru/app/streisand/id6450534064\">Streisand üåê</a>.\n2Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞.\n3Ô∏è‚É£ –ù–∞–∂–º–∏—Ç–µ <b>'–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è'</b>.\n\nüí° <b>–í–∞—à–∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:</b>\n- –í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.\n- –ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç–æ–ø-–ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤.\n- –°—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É.\n\n–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ ‚Äî –º—ã —Ä—è–¥–æ–º! üëá",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üñ• –ß–∞—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏",
                        "url": "https://t.me/supservru"
                    },
                    {
                        "text": "üîë –°–ø–∏—Å–æ–∫ VPN –∫–ª—é—á–µ–π",
                        "callback_data": "/list"
                    }
                ],
                [
                    {
                        "text": "üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ–± –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏",
                        "web_app": {
                            "url": "https://support.mrzbcli.ru/xray.html"
                        }
                    }
                ],
				
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}


<% CASE ['/wg', 'üñ• –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ WireGuard'] %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendPhoto": {
        "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
        "protect_content": true,
        "parse_mode": "HTML",
        "caption": "üõ°Ô∏è <b>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ WireGuard</b>\n\nüì± <b>–î–ª—è Android –∏ iOS:</b>\n1Ô∏è‚É£ –°–∫–∞—á–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ WireGuard:\n   ‚Ä¢ <a href=\"https://play.google.com/store/apps/details?id=com.wireguard.android\">Android</a>\n   ‚Ä¢ <a href=\"https://apps.apple.com/ru/app/wireguard/id1441195209\">iOS</a>\n\n2Ô∏è‚É£ –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –Ω–∞–∂–º–∏—Ç–µ <b>'–î–æ–±–∞–≤–∏—Ç—å —Ç—É–Ω–Ω–µ–ª—å'</b>.\n3Ô∏è‚É£ –í—Å—Ç–∞–≤—å—Ç–µ –∫–ª—é—á WireGuard –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (—Ñ–∞–π–ª .conf).\n4Ô∏è‚É£ –ù–∞–∂–º–∏—Ç–µ <b>'–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è'</b> ‚Äî –Ω–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º!\n\nüíª <b>–î–ª—è Windows –∏ macOS:</b>\n1Ô∏è‚É£ –°–∫–∞—á–∞–π—Ç–µ WireGuard —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞: <a href=\"https://www.wireguard.com/install/\">WireGuard</a>.\n2Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.\n3Ô∏è‚É£ –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –∫–ª—é—á –≤—Ä—É—á–Ω—É—é.\n4Ô∏è‚É£ –ù–∞–∂–º–∏—Ç–µ <b>'Activate'</b>, —á—Ç–æ–±—ã –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è.\n\nüîê <b>–ü–æ—á–µ–º—É WireGuard?</b>\n- –í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å.\n- –ü—Ä–æ—Å—Ç–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.\n- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.\n\n–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –Ω–∞—à—É –ø–æ–¥–¥–µ—Ä–∂–∫—É üëá",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üñ• –ß–∞—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏",
                        "url": "https://t.me/idsmef"
                    },
                    {
                        "text": "üîë –°–ø–∏—Å–æ–∫ VPN –∫–ª—é—á–µ–π",
                        "callback_data": "/list"
                    }
                ],
                [
                    {
                        "text": "üìñ –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è",
                        "web_app": {
                            "url": "https://support.mrzbcli.ru/wg.html"
                        }
                    }
                ],
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}


<% CASE ['/profile', 'üë§ –ü—Ä–æ—Ñ–∏–ª—å'] %>
{
  "deleteMessage": { "message_id": {{ message.message_id }} }
},
{{ userlogs = user.services.list_for_api('usi', {}) }}
{{ last_payment = user.payments.last() }}
{{ forecast = user.pays.forecast }}
{{ user_services = ref(user.services.list_for_api('category', '%')) }}
{{ current_service = user.services.current() }}
{{ USE date }}

{
  "sendPhoto": {
    "chat_id": {{ message.chat.id }},
    "photo": "https://sun9-73.userapi.com/impg/e8pkzF2oh-Ac40ZO_dpgJLHT__K9BlIX3I5aaA/O0QGe8WxUg0.jpg?size=1024x1024&quality=95&sign=7bda3be0397d08e13d7edb0db5e1f8a5&type=album",
    "caption": "üë§ <b>–õ–æ–≥–∏–Ω:</b> {{ user.login }}\nüîë <b>–ò–º—è:</b> {{ user.full_name }}\nüí∞ <b>–ë–∞–ª–∞–Ω—Å:</b> {{ user.balance }} —Ä—É–±.\nüéÅ <b>–ë–æ–Ω—É—Å—ã:</b> {{ user.get_bonus }}\nüîñ <b>–°–∫–∏–¥–∫–∞:</b> {{ user.discount }}%\n\nüì¶ <b>–ê–∫—Ç–∏–≤–Ω—ã–µ —É—Å–ª—É–≥–∏:</b>\n{{ IF user_services.size > 0 }}{{ FOR service IN user_services }} - {{ service.name }} ({{ service.cost }} —Ä—É–±.)\n{{ END }}{{ ELSE }}–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —É—Å–ª—É–≥.\n{{ END }}\nüï∞Ô∏è <b>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</b> {{ date.format(user.created, '%d.%m.%Y –≤ %H:%M') }}\n‚è≥ <b>–°–ª–µ–¥—É—é—â–µ–µ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ:</b> {{ date.format(userlogs.expire, '%H:%M %d.%m.%Y') }}\nüíµ <b>–û–∂–∏–¥–∞–µ–º–∞—è –æ–ø–ª–∞—Ç–∞:</b> {{ forecast.total }} —Ä—É–±.\n{{ IF last_payment }}üí≥ <b>–ü–æ—Å–ª–µ–¥–Ω–∏–π –ø–ª–∞—Ç—ë–∂:</b> {{ last_payment.money }} —Ä—É–±. ({{ date.format(last_payment.date, '%d.%m.%Y') }})\n{{ END }}\n{{ IF user_services.next }}‚è≥ <b>–°–º–µ–Ω–∞ —Ç–∞—Ä–∏—Ñ–∞ –Ω–∞:</b> {{ user_services.next }}\nüîÑ <b>–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞:</b> {{ date.format(userlogs.expire, '%H:%M %d.%m.%Y') }} (–ú–°–ö){{ END }}\n\n<b>–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –≤—ã —Å –Ω–∞–º–∏! –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã, –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.</b>",
    "parse_mode": "HTML",
    "reply_markup": {
      "inline_keyboard": [
        [
          { "text": "üéüÔ∏è –ü—Ä–æ–º–æ–∫–æ–¥", "callback_data": "/promocode" },
          { "text": "üöÄ –°–ø–∏—Å–æ–∫ –≤–∞—à–∏—Ö —É—Å–ª—É–≥", "callback_data": "/tariff_list" },
          { "text": "üîë –°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å", "callback_data": "/resetpassword" }
        ],
        [
          { "text": "üè† –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", "callback_data": "/menu" }
        ]
      ]
    }
  }
}

<% CASE ['/resetpassword'] %>
{
  "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
  "sendMessage": {
    "chat_id": {{ message.chat.id }},
    "parse_mode": "HTML",
    "text": "üîë <b>–í–∞—à –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!</b>\n\n<b>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å:</b> <code>{{ user.set_new_passwd }}</code>\n\n<b>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ <a href='{{ config.cli.url }}'>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>.</b>",
    "reply_markup": {
      "inline_keyboard": [
        [
          { "text": "üè† –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", "callback_data": "/menu" }
        ]
      ]
    }
  }
}

<% CASE ['/change_tariff'] %>
{
  "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
  arr = ref(user.services.list_for_api('limit', 0, 'filter', {}))
  

  {{ IF item }}
    {{ user = user.switch(item.user_id) }}
    {{ us.id(item.user_service_id).set('next', item.service_id) }}


    "sendMessage": {
      "chat_id": {{ message.chat.id }},
      "parse_mode": "HTML",
      "text": "üîë <b>–í–∞—à –Ω–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω—ë–Ω!</b>\n\n<b>–í—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∞—Ä–∏—Ñ:</b> <code>{{ item.service_id }}</code>\n<b>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É—Å–ª—É–≥.</b>\n",
      "reply_markup": {
        "inline_keyboard": [
          [
            { "text": "üè† –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", "callback_data": "/menu" }
          ]
        ]
      }
    }
  {{ ELSE }}
    "sendMessage": {
      "chat_id": {{ message.chat.id }},
      "parse_mode": "HTML",
      "text": "‚ùå <b>–û—à–∏–±–∫–∞:</b> –¢–∞—Ä–∏—Ñ –Ω–µ –Ω–∞–π–¥–µ–Ω.",
      "reply_markup": {
        "inline_keyboard": [
          [
            { "text": "üè† –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", "callback_data": "/menu" }
          ]
        ]
      }
    }
  {{ END }}
}



<% CASE '/tariff_list' %>
{{
  offset = args.0 || 0
  items = ref( user.services.list_for_api('limit',limit, 'offset',offset) )
}}
{{ FOR item IN items }}
{{ data.push(
    [{
      "text" = '–£—Å–ª—É–≥–∞: ' _ item.name _ ' ID: ' _  item.user_service_id
      "callback_data" = '/service ' _ item.user_service_id
    }]
  )
}}
{{ END }}

{{ data.push(
    [{
      "text" = '–ï—â–µ...'
      "callback_data" = '/list ' _ (limit + offset)
    }]
  ) IF items.size == limit
}}

{
  "sendMessage": {
    "text": "–°–ø–∏—Å–æ–∫ —É—Å–ª—É–≥",
    "reply_markup" : {
      "inline_keyboard": {{ toJson( data ) }}
    }
  }
}




<% CASE ['/adminmenu', 'üì° –ê–¥–º–∏–Ω–∫–∞'] %>
{
    {{ IF message.chat.id == config.telegram_admin.id }}
    "sendMessage": {
        "parse_mode": "HTML",
        "text": "üì° –ê–¥–º–∏–Ω–∫–∞",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    }
                ],
                [
                    {
                        "text": "–ê–∫—Ü–∏–∏",
                        "callback_data": "/admakcii"
                    }
                ],
                [
                    {
                        "text": "–î–æ—Ö–æ–¥",
                        "callback_data": "/payitogo"
                    }
                ],
                [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
    {{ END }}
}
<% CASE ['/admusers', '/qadmusers'] %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{
  limit = 10
  data = []
}}
{{
  offset = args.0 || 0
  itemsa = ref( user.list_for_api('admin',1,'limit',limit, 'offset',offset,'sort_direction'asc,'filter',{"gid" = 0}) )
}}
{{ FOR itema IN itemsa }}
{{ status = (itema.block == 0 ? "üü¢" : "üî¥") }}
{{ data.push(
    [{
      "text" = status _ itema.user_id _ '.' _ itema.full_name _ '-' _ itema.login
      "callback_data" = '/admuser ' _ itema.user_id
    }]
  )
}}
{{ END }}
{{ IF itemsa.size == limit }}
{{ data.push(
    [{
      "text" = '–î–∞–ª–µ–µ ‚ñ∂Ô∏è',
      "callback_data" = '/admusers ' _ (limit + offset)
    }]
  )
}}
{{ END }}
{{ IF offset > 0 }}
{{ data.push(
    [{
      "text" = '‚óÄÔ∏è –ù–∞–∑–∞–¥',
      "callback_data" = '/admusers ' _ (offset - limit)
    }]
  )
}}
{{ END }}
{{ data.push(
 [{
      "text" = '–í–µ—Å—å —Å–ø–∏—Å–æ–∫',
      "callback_data" = '/admusersall'
    }], [{
      "text" = '–ê–¥–º–∏–Ω–∫–∞'
      "callback_data" = '/adminmenu'
    },{
      "text" = 'üè† –î–æ–º–æ–π'
      "callback_data" = '/menu'
    }]
  )
}}
{{ IF cmd == '/qadmusers' }}
{
    "sendMessage": {
{{ END }}
{{ IF cmd == '/admusers' }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
{{ END }}
    "text": "–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
    "reply_markup" : {
      "inline_keyboard": {{ toJson( data ) }}
    }
  }
}
{{ END }}
<% CASE '/admusersall' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
        "reply_markup" : {
            "inline_keyboard": [
                {{ FOR itema IN ref(user.list_for_api( 'admin', 1, 'limit', 999).nsort('user_id')) }}
                  {{ IF itema.gid == 0 }}
                [
                    {
                        "text": "{{ IF itema.block == 0}}üü¢{{ ELSE }}üî¥{{ END }}{{ itema.user_id }}.{{ itema.full_name }}  - {{ itema.login }} ",
                        "callback_data": "/admuser {{ itema.user_id }} "
                    }
                ],    {{ END }}  
{{ END }}           
                  [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admusers"
                    }
                ],[
                    {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }, {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ END }}
<% CASE ['/admuser', '/qadmuser'] %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ user_services = ref(user.services.list_for_api('category','%')) }}
{{ FOR itemlk IN ref(user.id(args.0)) }}
{{ IF cmd == '/qadmuser' }}
{
    "sendMessage": {
{{ END }}
{{ IF cmd == '/admuser' }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
{{ END }}
        "text": "{{ itemlk.full_name }}\n{{ itemlk.login }}\n–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: {{ itemlk.created }}\n–£—Å–ª—É–≥: {{ user_services.size }}\n–ë–∞–ª–∞–Ω—Å: {{ itemlk.balance }}‚ÇΩ\n–°–∫–∏–¥–∫–∞: {{ itemlk.discount }}%\n–ë–æ–Ω—É—Å—ã: {{ itemlk.get_bonus }}{{ IF user.block == 1 }}\nüî¥ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω{{ END }}",
        "reply_markup" : {
            "inline_keyboard": [
                         {{ IF user.block == 0 }}
                         {{ IF user_services.size > 0 }}
                       [
                    {
                        "text": "–£—Å–ª—É–≥–∏",
                        "callback_data": "/admservice {{ itemlk.id }}"
                    }
                ],{{ ELSE }} 
                 [
                    {
                        "text": "–î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É",
                        "callback_data": "/admpricelist {{ itemlk.id }}"
                    }
                ],
                  {{ END }} [
                    {
                        "text": "–ü–ª–∞—Ç–µ–∂–∏",
                        "callback_data": "/admpay {{ itemlk.id }}"
                    }
                ],[
                    {
                        "text": "–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π",
                        "callback_data": "/admpayhistory {{ itemlk.id }}"
                    }
                ],
                 [
                    {
                        "text": "–ë–æ–Ω—É—Å—ã",
                        "callback_data": "/admpayb {{ itemlk.id }}"
                    }
                ], [
                    {
                        "text": "–ù–∞–ø–∏—Å–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é",
                        "callback_data": "/admusermsg {{ user.settings.telegram.chat_id }}"
                    }
                ],{{ END }}
                  {{ IF user.block == 0 }}
                     [
                    {
                        "text": "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å",
                        "callback_data": "/admuserblock {{ itemlk.id }}"
                    }
                ], {{ ELSE }}[
                    {
                        "text": "–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å",
                        "callback_data": "/admuseractiv {{ itemlk.id }}"
                    }
                ],
               {{ END }}
                 [
                   {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    }, {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]{{ END }}    
        }
    }
}
{{ END }}
<% CASE '/admusermsg' %>
{
"sendMessage": {
        "text": "#{{ args.0 }}#\n–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        "reply_markup": {
            "force_reply": true
        }
    }
}
<% CASE '/admservice' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ FOR itemlks IN ref(user.id(args.0)) }}
{{ user = user.switch(args.0) }}
{{ usis = user.services.list_for_api( 'usi', args.1 ) }}
{{ USE date }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–£—Å–ª—É–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:\n{{ itemlks.full_name }}\n{{ itemlks.login }}\n–£—Å–ª—É–≥–∞: {{ usis.name }}\n–°—Ç–∞—Ç—É—Å: {{ usis.status }}\n–°–æ–∑–¥–∞–Ω: {{ usis.created }}\n–û–ø–¥–∞—á–µ–Ω –¥–æ: {{ usis.expire }}{{ IF usis.next }} {{ FOR itemis IN ref(service.api_price_list)}}{{ IF itemis.service_id == usis.next }}\n\n<b>–°–º–µ–Ω–∞ —Ç–∞—Ä–∏—Ñ–∞:</b>{{ itemis.name }} \n–ü—Ä–æ–∏–∑–æ–π–¥—ë—Ç: {{ date.format(usis.expire, '%H:%M %d.%m.%Y') }}  (–ú–°–ö) {{ END }} {{ END }}{{ ELSE }}  {{ END }}",
        "reply_markup" : {
            "inline_keyboard": [
               {{ IF usis.status == 'ACTIVE' }}     
                 [
                    {
                        "text": "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —É—Å–ª—É–≥—É",
                        "callback_data": "/admusiblock {{ user.id }}"
                    }
                ],  {{ ELSE }}         
              [
                    {
                        "text": "–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —É—Å–ª—É–≥—É",
                        "callback_data": "/admusiactive {{ user.id }}"
                    }
                ],    {{ END }}   
{{ IF usis.next }}
{{ FOR itemis IN ref(service.api_price_list)}}
{{ IF itemis.service_id == usis.next }}
                 [
                    {
                        "text": "–û—Ç–º–µ–Ω–∏—Ç—å —Å–º–µ–Ω—É —Ç–∞—Ä–∏—Ñ–∞",
                        "callback_data": "/admchoisenull {{ user.id }}"
                    }
                ],
{{ END }} {{ END }}
{{ ELSE }} 
                   [
                    {
                        "text": "–ò–∑–º–µ–Ω–∏—Ç—å —Ç–∞—Ä–∏—Ñ",
                        "callback_data": "/admsmena {{ user.id }}"
                    }
                ],
{{ END }}
                [
                    {
                        "text": "‚ùå –£–¥–∞–ª–∏—Ç—å —É—Å–ª—É–≥—É",
                        "callback_data": "/admdelete {{ user.id }}"
                    }
                ], [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                    {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },{
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]{{ END }}    
        }
    }
}
{{ END }}
<% CASE '/admpricelist' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "‚ò∑ –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É –¥–ª—è\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {{ user.full_name }}",
        "reply_markup" : {
            "inline_keyboard": [
                {{ FOR itemprl IN ref(service.api_price_list).nsort('cost') }}
                [
                    {
                        "text": "{{ itemprl.name }}.",
                        "callback_data": "/admserviceorder {{ user.id }} 0 {{ itemprl.service_id }}"
                    }
                ],
                {{ END }}
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                   {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    }, {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }}
<% CASE '/admserviceorder' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }} }
},
{
    "shmServiceOrder": {
        "service_id": "{{ args.2 }}",
        "callback_data": "/admuser {{ user.id }}",
        "cb_not_enough_money": "/admuser {{ user.id }}",
        "error": "–û–®–ò–ë–ö–ê"
    }
}{{ END }}
<% CASE '/admuserblock' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ usisbl = user.services.list_for_api('usi', {}) }}
{{ usblall =  us.id(usisbl.user_service_id(usisbl.user_service_id)).block }}
{{ userblocks = user.set('block',1) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {{ user.full_name }}\n–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ωüî¥\n–£—Å–ª—É–≥–∞: {{ usisbl.name }}\n–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞üî¥",
        "reply_markup" : {
            "inline_keyboard": [
                       [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                     {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },{
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ END }}
<% CASE '/admuseractiv' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ usisact = user.services.list_for_api('usi', {}) }}
{{ activ =  us.id(usisact.user_service_id(usisact.user_service_id)).activate }}
{{ useractivs = user.set('block',0) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {{ user.full_name }}\n–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ωüü¢\n–£—Å–ª—É–≥–∞: {{ usisact.name }}\n–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞üü¢",
        "reply_markup" : {
            "inline_keyboard": [
                       [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                     {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },{
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ END }}
<% CASE '/admusiblock' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ usisb = user.services.list_for_api('usi', {}) }}
{{ blocks =  us.id(usisb.user_service_id(usisb.user_service_id)).block }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {{ user.full_name }}\n–£—Å–ª—É–≥–∞: {{ usisb.name }}\n–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ",
        "reply_markup" : {
            "inline_keyboard": [
                       [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                     {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },{
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ END }}
<% CASE '/admusiactive' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ usisa = user.services.list_for_api('usi', {}) }}
{{ activ =  us.id(usisa.user_service_id(usisa.user_service_id)).activate }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {{ user.full_name }}\n–£—Å–ª—É–≥–∞: {{ usisa.name }}\n–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ",
        "reply_markup" : {
            "inline_keyboard": [
                       [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                     {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/users"
                    },{
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/admin"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ END }}
<% CASE '/admsmena' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ ussm = user.services.list_for_api('usi', {}) }}
{{ USE date }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–°–º–µ–Ω–∞ —Ç–∞—Ä–∏—Ñ–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–æ–¥–ª–µ–Ω–∏–∏\n\n<b>–¢–µ–∫—É—â–∏–π —Ç–∞—Ä–∏—Ñ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {{ user.full_name }}\n</b>{{ ussm.name }}\n<b>–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ</b>: {{ date.format(us.expire, '%H:%M %d.%m.%Y') }}  (–ú–°–ö)\n\n<b>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –ø–µ—Ä–∏–æ–¥</b>",
        "reply_markup" : {
            "inline_keyboard": [               
                {{ FOR itemsm IN ref(service.api_price_list).nsort('cost') }}                 
                [
                    {
                        "text": "{{ itemsm.name }}.",
                        "callback_data": "/admchoise {{ ussm.user_id }} 0 {{ itemsm.service_id }}"
                    }
                ],
                {{ END }} 
                  [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                   {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    }, {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }} 
<% CASE '/admchoise' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ itemadmch = user.services.list_for_api('usi', {}) }}
{{ ntch = us.id(itemadmch.user_service_id).set('next', args.2) }}
{{ USE date }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–¢–∞—Ä–∏—Ñ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {{ user.full_name }} –∏–∑–º–µ–Ω—ë–Ω. \n\n–°–º–µ–Ω–∞ —Ç–∞—Ä–∏—Ñ–∞ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç {{ date.format(us.expire, '%H:%M %d.%m.%Y') }}",
        "reply_markup" : {
            "inline_keyboard": [ 
                  [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ],[
                   {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    }, {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }}
<% CASE '/admchoisenull' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ itemadmchn = user.services.list_for_api('usi', {}) }}
{{ ntchn = us.id(itemadmchn.user_service_id).set('next') }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–°–º–µ–Ω–∞ —Ç–∞—Ä–∏—Ñ–∞: {{ itemadmchn.name }}\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {{ user.full_name }}\n–û—Ç–º–µ–Ω–µ–Ω–∞.",
        "reply_markup" : {
            "inline_keyboard": [ 
                  [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                   {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    }, {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
{{ END }}
<% CASE '/admdelete' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ usisdel = user.services.list_for_api( 'usi', {} ) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–£–¥–∞–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∏: {{ usisdel.name }}\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {{ user.full_name }}\n\nü§î <b>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ. –ö–ª—é—á –Ω–µ–ª—å–∑—è –±—É–¥–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å!</b>",
        "reply_markup" : {
            "inline_keyboard": [
                [
                    {
                        "text": "üóë –î–ê, –£–î–ê–õ–ò–¢–¨! üóë",
                        "callback_data": "/admdelete_confirmed {{ user.id }}"
                    }
                ],
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                   {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    }, {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }}
<% CASE '/admdelete_confirmed' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ usisdels = user.services.list_for_api( 'usi', {} ) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }} }
},
{
    "billshmServiceDelete": {
        "usi": "{{ usisdels.user_service_id }}",
        "callback_data": "/admuser {{ user.id }}",
        "error": "–û–®–ò–ë–ö–ê"
    }
}
 {{ END }}
<% CASE '/admpay' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ FOR itempl IN ref(user.id(args.0)) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "{{ itempl.full_name }}\n–ë–∞–ª–∞–Ω—Å: {{ itempl.balance }}‚ÇΩ\n\n–ó–∞—á–∏—Å–ª–∏—Ç—å:",
        "reply_markup" : {
            "inline_keyboard": [
                       [
                    {
                        "text": "10‚ÇΩ",
                        "callback_data": "/admpayment {{ itempl.user_id }} 10"
                    }
                ], [
                    {
                        "text": "50‚ÇΩ",
                        "callback_data": "/admpayment {{ itempl.user_id }} 50"
                    }
                ], [
                    {
                        "text": "100‚ÇΩ",
                        "callback_data": "/admpayment {{ itempl.user_id }} 100"
                    }
                ],
                           [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                   {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    }, {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]{{ END }}    
        }
    }
}
{{ END }}  
<% CASE '/admpayb' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ FOR itemplb IN ref(user.id(args.0)) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "{{ itemplb.full_name }}\n–ë–æ–Ω—É—Å–æ–≤: {{ itemplb.get_bonus }}\n\n–ó–∞—á–∏—Å–ª–∏—Ç—å –±–æ–Ω—É—Å–æ–≤:",
        "reply_markup" : {
            "inline_keyboard": [
                       [
                    {
                        "text": "10",
                        "callback_data": "/admpaymentb {{ itemplb.user_id }} 10"
                    }
                ], [
                    {
                        "text": "50",
                        "callback_data": "/admpaymentb {{ itemplb.user_id }} 50"
                    }
                ], [
                    {
                        "text": "100",
                        "callback_data": "/admpaymentb {{ itemplb.user_id }} 100"
                    }
                ],
                          [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ],  [
                    {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },{
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]{{ END }}    
        }
    }
}
{{ END }}  
<% CASE '/admpayment' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ pay = user.id(args.0).payment('money', args.1, 'pay_system_id', 'manual') }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {{ user.full_name }} –Ω–∞—á–∏—Å–ª–µ–Ω–æ {{ args.1 }}‚ÇΩ",
        "reply_markup" : {
            "inline_keyboard": [
                       [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                     {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },{
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }} 
<% CASE '/admpaymentb' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch( args.0 ) }}
{{ bon = user.add_bonus( args.1 ) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {{ userb.full_name }} –Ω–∞—á–∏—Å–ª–µ–Ω–æ {{ args.1 }}  - {{ args.0 }}–±–æ–Ω—É—Å–æ–≤",
        "reply_markup" : {
            "inline_keyboard": [
                       [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ],  [
                    {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },{
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }}
<% CASE '/payitogo' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ sum = 0 }}
{{ arr = ref(user.pays.list_for_api( 'admin', 1, 'limit', 0,  'filter', { 'date' => '2024-%-%'} )) }}
{{ FOR item IN arr }}
{{ sum = sum + item.money }}
{{ END }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–î–æ—Ö–æ–¥:\n–ò—Ç–æ–≥–æ –∑–∞ 2024 –≥–æ–¥: {{ sum }} —Ä—É–±.",
        "reply_markup" : {
            "inline_keyboard": [
                       [
                    {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }}
<% CASE '/admpayhistory' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{
    "editMessageText": {
        "message_id": {{ message.message_id }},
        "parse_mode":"HTML",
        "text": "–ü–ª–∞—Ç–µ–∂–∏",
        "reply_markup" : {
            "inline_keyboard": [
                {{ FOR itemhis IN ref(user.pays.list_for_api('limit', 10)) }}
                [
                    {
                        "text": "–î–∞—Ç–∞: {{ itemhis.date }}, –°—É–º–º–∞: {{ itemhis.money }} —Ä—É–±.",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ],
                {{ END }}
                 [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ], [
                    {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },{
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                 [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }}

<% CASE '/admdelete_confirmed' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ usisdels = user.services.list_for_api('usi', {}) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "text": "‚úÖ –£—Å–ª—É–≥–∞ —É–¥–∞–ª–µ–Ω–∞.",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ],
                [
                    {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },
                    {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
},
{
    "shmServiceDelete": {
        "usi": "{{ usisdels.user_service_id }}",
        "callback_data": "/admuser {{ user.id }}",
        "error": "–û–®–ò–ë–ö–ê"
    }
}{{ END }}

<% CASE '/admpay' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ FOR itempl IN ref(user.id(args.0)) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "üíµ <b>{{ itempl.full_name }}</b>\n–ë–∞–ª–∞–Ω—Å: {{ itempl.balance }}‚ÇΩ\n\n<b>–ó–∞—á–∏—Å–ª–∏—Ç—å:</b>",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "10‚ÇΩ",
                        "callback_data": "/admpayment {{ itempl.user_id }} 10"
                    }
                ],
                [
                    {
                        "text": "50‚ÇΩ",
                        "callback_data": "/admpayment {{ itempl.user_id }} 50"
                    }
                ],
                [
                    {
                        "text": "100‚ÇΩ",
                        "callback_data": "/admpayment {{ itempl.user_id }} 100"
                    }
                ],
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ],
                [
                    {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },
                    {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }}

<% CASE '/admpayb' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ FOR itemplb IN ref(user.id(args.0)) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "üéÅ <b>{{ itemplb.full_name }}</b>\n–ë–æ–Ω—É—Å–æ–≤: {{ itemplb.get_bonus }}\n\n<b>–ó–∞—á–∏—Å–ª–∏—Ç—å –±–æ–Ω—É—Å–æ–≤:</b>",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "10",
                        "callback_data": "/admpaymentb {{ itemplb.user_id }} 10"
                    }
                ],
                [
                    {
                        "text": "50",
                        "callback_data": "/admpaymentb {{ itemplb.user_id }} 50"
                    }
                ],
                [
                    {
                        "text": "100",
                        "callback_data": "/admpaymentb {{ itemplb.user_id }} 100"
                    }
                ],
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ],
                [
                    {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },
                    {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }}

<% CASE '/admpayment' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ pay = user.id(args.0).payment('money', args.1, 'pay_system_id', 'manual') }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "üí∞ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é <b>{{ user.full_name }}</b> –Ω–∞—á–∏—Å–ª–µ–Ω–æ <b>{{ args.1 }}‚ÇΩ</b>",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ],
                [
                    {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },
                    {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }}

<% CASE '/admpaymentb' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{{ bon = user.add_bonus(args.1) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "üéâ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é <b>{{ user.full_name }}</b> –Ω–∞—á–∏—Å–ª–µ–Ω–æ <b>{{ args.1 }}</b> –±–æ–Ω—É—Å–æ–≤",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ],
                [
                    {
                        "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },
                    {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }}

<% CASE '/payitogo' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ sum = 0 }}
{{ arr = ref(user.pays.list_for_api('admin', 1, 'limit', 0, 'filter', {'date' => '2024-%-%'})) }}
{{ FOR item IN arr }}
{{ sum = sum + item.money }}
{{ END }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "üìà <b>–î–æ—Ö–æ–¥:</b>\n–ò—Ç–æ–≥–æ –∑–∞ 2024 –≥–æ–¥: <b>{{ sum }} —Ä—É–±.</b>",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "–ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                [
                    {
                        "text": "üè† –î–æ–º–æ–π",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }}

<% CASE '/admpayhistory' %>
{{ IF message.chat.id == config.telegram_admin.id }}
{{ user = user.switch(args.0) }}
{
    "sendMessage": {
        "message_id": {{ message.message_id }},
        "parse_mode": "HTML",
        "text": "üí≥ <b>–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {{ user.full_name }}</b>",
        "reply_markup": {
            "inline_keyboard": [
                {{ payments = user.pays.list_for_api('limit', 10) }}
                {{ IF payments.length > 0 }}
                {{ FOR payment IN payments }}
                [
                    {
                        "text": "üóìÔ∏è –î–∞—Ç–∞: {{ payment.date }}, üí∞ –°—É–º–º–∞: {{ payment.money }} —Ä—É–±.",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ],
                {{ END }}
                {{ ELSE }}
                [
                    {
                        "text": "üö´ –ù–µ—Ç –ø–ª–∞—Ç–µ–∂–µ–π",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ],
                {{ END }}
                [
                    {
                        "text": "‚á¶ –ù–∞–∑–∞–¥",
                        "callback_data": "/admuser {{ user.id }}"
                    }
                ],
                [
                    {
                        "text": "üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                        "callback_data": "/admusers"
                    },
                    {
                        "text": "‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞",
                        "callback_data": "/adminmenu"
                    }
                ],
                [
                    {
                        "text": "üåç –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}{{ END }}



<% CASE %>
{{ IF message.reply_to_message and message.reply_to_message.chat.id == config.telegram_admin.id }}
{{ text = message.reply_to_message.caption || message.reply_to_message.text }}
{{ chatid = text.split('#').1 }}

{{ IF chatid }}
    {{ IF message.photo }}
    {
        "sendPhoto": {
            "protect_content": true,
            "parse_mode": "HTML",
            "chat_id": "{{ chatid }}",
            "photo": "{{ message.photo.0.file_id }}",
            "caption": "{{ message.text || '–ë–µ–∑ –ø–æ–¥–ø–∏—Å–∏' }}",
            "reply_markup": {
                "inline_keyboard": [
                    [
                        {
                            "text": "üè† –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç",
                            "callback_data": "/start"
                        }
                    ]
                ]
            }
        }
    }
    {{ ELSIF message.text }}
    {
        "sendPhoto": {
            "protect_content": true,
            "parse_mode": "HTML",
            "chat_id": "{{ chatid }}",
            "photo": "https://img.freepik.com/premium-vector/attention-danger-sign-caution-alert-icon-logo-attention-vector-alert-exclamation_41737-1005.jpg?w=320",
            "caption": "<b>{{ message.text }}</b>\n\n–° —É–≤–∞–∂–µ–Ω–∏–µ–º, –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è",
            "reply_markup": {
                "inline_keyboard": [
                    [
                        {
                            "text": "üè† –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç",
                            "callback_data": "/start"
                        }
                    ]
                ]
            }
        }
    }
    {{ ELSIF message.document }}
    {
        "sendDocument": {
            "protect_content": true,
            "parse_mode": "HTML",
            "chat_id": "{{ chatid }}",
            "document": "{{ message.document.file_id }}",
            "caption": "{{ message.text || '–ë–µ–∑ –ø–æ–¥–ø–∏—Å–∏' }}",
            "reply_markup": {
                "inline_keyboard": [
                    [
                        {
                            "text": "üè† –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç",
                            "callback_data": "/start"
                        }
                    ]
                ]
            }
        }
    }
    {{ ELSIF message.video }}
    {
        "sendVideo": {
            "protect_content": true,
            "parse_mode": "HTML",
            "chat_id": "{{ chatid }}",
            "video": "{{ message.video.file_id }}",
            "caption": "{{ message.caption || '–ë–µ–∑ –ø–æ–¥–ø–∏—Å–∏' }}",
            "reply_markup": {
                "inline_keyboard": [
                    [
                        {
                            "text": "üè† –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç",
                            "callback_data": "/start"
                        }
                    ]
                ]
            }
        }
    }
    {{ ELSE }}
    {
        "sendMessage": {
            "chat_id": "{{ chatid }}",
            "text": "–î–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, —Ñ–æ—Ç–æ, —Ñ–∞–π–ª—ã –∏ –≤–∏–¥–µ–æ"
        }
    }
    {{ END }}
{{ ELSE }}
{
    "sendMessage": {
        "chat_id": "{{ config.telegram_admin.id }}",
        "text": "–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ."
    }
}
{{ END }}

{{ ELSE }}
    {{ IF message.photo }}
    {
        "sendPhoto": {
            "protect_content": true,
            "parse_mode": "HTML",
            "chat_id": "{{ config.telegram_admin.id }}",
            "photo": "{{ message.photo.0.file_id }}",
            "caption": "#{{ user.settings.telegram.chat_id }}#\n–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç {{ user.full_name }} - {{ user.id }}:\n<a href=\"https://t.me/{{ user.settings.telegram.login }}\">{{ user.settings.telegram.login }}</a>\n\n{{ message.caption || '–ë–µ–∑ –ø–æ–¥–ø–∏—Å–∏' }}",
            "reply_markup": {
                "inline_keyboard": [
                    [
                        {
                            "text": "–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
                            "callback_data": "/qadmuser {{ user.id }}"
                        }
                    ],
                    [
                        {
                            "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                            "callback_data": "/qadmusers"
                        },
                        {
                            "text": "–ê–¥–º–∏–Ω–∫–∞",
                            "callback_data": "/qadminmenu"
                        }
                    ],
                    [
                        {
                            "text": "üè† –î–æ–º–æ–π",
                            "callback_data": "/start"
                        }
                    ]
                ]
            }
        }
    }
    {{ ELSIF message.text }}
    {
        "sendMessage": {
            "protect_content": true,
            "parse_mode": "HTML",
            "chat_id": "{{ config.telegram_admin.id }}",
            "text": "#{{ user.settings.telegram.chat_id }}#\n–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç {{ user.full_name }} - {{ user.id }}:\n<a href=\"https://t.me/{{ user.settings.telegram.login }}\">{{ user.settings.telegram.login }}</a>\n\n{{ message.text }}",
            "reply_markup": {
                "inline_keyboard": [
                    [
                        {
                            "text": "–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
                            "callback_data": "/qadmuser {{ user.id }}"
                        }
                    ],
                    [
                        {
                            "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                            "callback_data": "/qadmusers"
                        },
                        {
                            "text": "–ê–¥–º–∏–Ω–∫–∞",
                            "callback_data": "/qadminmenu"
                        }
                    ],
                    [
                        {
                            "text": "üè† –î–æ–º–æ–π",
                            "callback_data": "/start"
                        }
                    ]
                ]
            }
        }
    }
    {{ ELSIF message.document }}
    {
        "sendDocument": {
            "protect_content": true,
            "parse_mode": "HTML",
            "chat_id": "{{ config.telegram_admin.id }}",
            "document": "{{ message.document.file_id }}",
            "caption": "#{{ user.settings.telegram.chat_id }}#\n–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç {{ user.full_name }} - {{ user.id }}:\n<a href=\"https://t.me/{{ user.settings.telegram.login }}\">{{ user.settings.telegram.login }}</a>\n\n{{ message.caption || '–ë–µ–∑ –ø–æ–¥–ø–∏—Å–∏' }}",
            "reply_markup": {
                "inline_keyboard": [
                    [
                        {
                            "text": "–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
                            "callback_data": "/qadmuser {{ user.id }}"
                        }
                    ],
                    [
                        {
                            "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                            "callback_data": "/qadmusers"
                        },
                        {
                            "text": "–ê–¥–º–∏–Ω–∫–∞",
                            "callback_data": "/qadminmenu"
                        }
                    ],
                    [
                        {
                            "text": "üè† –î–æ–º–æ–π",
                            "callback_data": "/start"
                        }
                    ]
                ]
            }
        }
    }
    {{ ELSIF message.video }}
    {
        "sendVideo": {
            "protect_content": true,
            "parse_mode": "HTML",
            "chat_id": "{{ config.telegram_admin.id }}",
            "video": "{{ message.video.file_id }}",
            "caption": "#{{ user.settings.telegram.chat_id }}#\n–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç {{ user.full_name }} - {{ user.id }}:\n<a href=\"https://t.me/{{ user.settings.telegram.login }}\">{{ user.settings.telegram.login }}</a>\n\n{{ message.caption || '–ë–µ–∑ –ø–æ–¥–ø–∏—Å–∏' }}",
            "reply_markup": {
                "inline_keyboard": [
                    [
                        {
                            "text": "–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
                            "callback_data": "/qadmuser {{ user.id }}"
                        }
                    ],
                    [
                        {
                            "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
                            "callback_data": "/qadmusers"
                        },
                        {
                            "text": "–ê–¥–º–∏–Ω–∫–∞",
                            "callback_data": "/qadminmenu"
                        }
                    ],
                    [
                        {
                            "text": "üè† –î–æ–º–æ–π",
                            "callback_data": "/start"
                        }
                    ]
                ]
            }
        }
    }
    {{ ELSE }}
    {
        "sendMessage": {
            "text": "–î–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, —Ñ–æ—Ç–æ, —Ñ–∞–π–ª—ã –∏ –≤–∏–¥–µ–æ"
        }
    }
    {{ END }}

{{ END }}

<% END %>
